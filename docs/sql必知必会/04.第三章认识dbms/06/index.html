<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"
    />
    <link rel="shortcut icon" type="image/x-icon" href="/logo.png" />
    <link rel="stylesheet" href="/blog-base/umi.css" />
    <script>
      window.routerBase = "/blog-base";
    </script>
    <script>
      window.publicPath = window.resourceBaseUrl || "/blog-base/";
    </script>
    <script>
      //! umi version: 3.5.41
    </script>
    <script>
      !(function () {
        var e =
            navigator.cookieEnabled && void 0 !== window.localStorage
              ? localStorage.getItem("dumi:prefers-color")
              : "auto",
          o = window.matchMedia("(prefers-color-scheme: dark)").matches,
          t = ["light", "dark", "auto"];
        document.documentElement.setAttribute(
          "data-prefers-color",
          e === t[2] ? (o ? t[1] : t[0]) : t.indexOf(e) > -1 ? e : t[0]
        );
      })();
    </script>
    <title>43丨如何使用Redis搭建玩家排行榜？ - 大师兄</title>
  </head>
  <body>
    <div id="root"><div class="__dumi-default-layout" data-route="/sql必知必会/04.第三章认识dbms/06" data-show-sidemenu="true" data-show-slugs="true" data-site-mode="true" data-gapless="false"><div class="__dumi-default-navbar" data-mode="site"><button class="__dumi-default-navbar-toggle"></button><a class="__dumi-default-navbar-logo" style="background-image:url(&#x27;/logo.png&#x27;)" href="/blog-base/">大师兄</a><nav><div class="__dumi-default-search"><input type="search" class="__dumi-default-search-input" value=""/><ul></ul></div><span>计算机基础<ul><li><a href="/blog-base/编译原理之美">编译原理之美</a></li><li><a href="/blog-base/编译原理实战">编译原理实战</a></li><li><a href="/blog-base/深入浅出计算机组成原理">深入浅出计算机组成原理</a></li><li><a href="/blog-base/详解http">详解http</a></li><li><a href="/blog-base/计算机网络通关29讲">计算机网络通关29讲</a></li><li><a href="/blog-base/网络排查案例课">网络排查案例课</a></li><li><a href="/blog-base/linux操作系统">linux操作系统</a></li><li><a href="/blog-base/linux内核技术实战课">linux内核技术实战课</a></li><li><a href="/blog-base/linux性能优化实战">linux性能优化实战</a></li><li><a href="/blog-base/程序员数学基础">程序员数学基础</a></li><li><a href="/blog-base/趣谈网络协议">趣谈网络协议</a></li><li><a href="/blog-base/操作系统实战">操作系统实战</a></li><li><a href="/blog-base/软件工程之美">软件工程之美</a></li><li><a aria-current="page" class="active" href="/blog-base/sql必知必会">sql必知必会</a></li><li><a href="/blog-base/操作系统实战45讲">操作系统实战45讲</a></li><li><a href="/blog-base/网络编程实战">网络编程实战</a></li><li><a href="/blog-base/趣谈linux操作系统">趣谈linux操作系统</a></li></ul></span><span>算法<ul><li><a href="/blog-base/常用算法25讲">常用算法25讲</a></li><li><a href="/blog-base/数据结构与算法之美">数据结构与算法之美</a></li><li><a href="/blog-base/业务开发算法50讲">业务开发算法50讲</a></li><li><a href="/blog-base/动态规划面试宝典">动态规划面试宝典</a></li></ul></span><span>前端开发<ul><li><a href="/blog-base/正则表达式入门">正则表达式入门</a></li></ul></span><span>前端工程化</span><span>前端性能优化</span><span>移动端开发</span><span>软件测试</span><span>产品与用户体验</span><span>面试</span><span>杂谈<ul><li><a href="/blog-base/代码之丑">代码之丑</a></li><li><a href="/blog-base/代码精进之路">代码精进之路</a></li><li><a href="/blog-base/数据分析思维课">数据分析思维课</a></li><li><a href="/blog-base/朱涛kotlin编程第一课">朱涛kotlin编程第一课</a></li><li><a href="/blog-base/重学线性代数">重学线性代数</a></li></ul></span><div class="__dumi-default-navbar-tool"><div class="__dumi-default-dark"><div class="__dumi-default-dark-switch "></div></div></div></nav></div><div class="__dumi-default-menu" data-mode="site"><div class="__dumi-default-menu-inner"><div class="__dumi-default-menu-header"><a class="__dumi-default-menu-logo" style="background-image:url(&#x27;/logo.png&#x27;)" href="/blog-base/"></a><h1>大师兄</h1><p></p></div><div class="__dumi-default-menu-mobile-area"><ul class="__dumi-default-menu-nav-list"><li>计算机基础<ul><li><a href="/blog-base/编译原理之美">编译原理之美</a></li><li><a href="/blog-base/编译原理实战">编译原理实战</a></li><li><a href="/blog-base/深入浅出计算机组成原理">深入浅出计算机组成原理</a></li><li><a href="/blog-base/详解http">详解http</a></li><li><a href="/blog-base/计算机网络通关29讲">计算机网络通关29讲</a></li><li><a href="/blog-base/网络排查案例课">网络排查案例课</a></li><li><a href="/blog-base/linux操作系统">linux操作系统</a></li><li><a href="/blog-base/linux内核技术实战课">linux内核技术实战课</a></li><li><a href="/blog-base/linux性能优化实战">linux性能优化实战</a></li><li><a href="/blog-base/程序员数学基础">程序员数学基础</a></li><li><a href="/blog-base/趣谈网络协议">趣谈网络协议</a></li><li><a href="/blog-base/操作系统实战">操作系统实战</a></li><li><a href="/blog-base/软件工程之美">软件工程之美</a></li><li><a aria-current="page" class="active" href="/blog-base/sql必知必会">sql必知必会</a></li><li><a href="/blog-base/操作系统实战45讲">操作系统实战45讲</a></li><li><a href="/blog-base/网络编程实战">网络编程实战</a></li><li><a href="/blog-base/趣谈linux操作系统">趣谈linux操作系统</a></li></ul></li><li>算法<ul><li><a href="/blog-base/常用算法25讲">常用算法25讲</a></li><li><a href="/blog-base/数据结构与算法之美">数据结构与算法之美</a></li><li><a href="/blog-base/业务开发算法50讲">业务开发算法50讲</a></li><li><a href="/blog-base/动态规划面试宝典">动态规划面试宝典</a></li></ul></li><li>前端开发<ul><li><a href="/blog-base/正则表达式入门">正则表达式入门</a></li></ul></li><li>前端工程化</li><li>前端性能优化</li><li>移动端开发</li><li>软件测试</li><li>产品与用户体验</li><li>面试</li><li>杂谈<ul><li><a href="/blog-base/代码之丑">代码之丑</a></li><li><a href="/blog-base/代码精进之路">代码精进之路</a></li><li><a href="/blog-base/数据分析思维课">数据分析思维课</a></li><li><a href="/blog-base/朱涛kotlin编程第一课">朱涛kotlin编程第一课</a></li><li><a href="/blog-base/重学线性代数">重学线性代数</a></li></ul></li></ul><div class="__dumi-default-dark"><div class="__dumi-default-dark-switch "><button title="Dark theme" class="__dumi-default-dark-moon "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3854" width="22" height="22"><path d="M991.816611 674.909091a69.166545 69.166545 0 0 0-51.665455-23.272727 70.795636 70.795636 0 0 0-27.438545 5.585454A415.674182 415.674182 0 0 1 754.993338 698.181818c-209.594182 0-393.472-184.785455-393.472-395.636363 0-52.363636 38.539636-119.621818 69.515637-173.614546 4.887273-8.610909 9.634909-16.756364 14.103272-24.901818A69.818182 69.818182 0 0 0 384.631156 0a70.842182 70.842182 0 0 0-27.438545 5.585455C161.678429 90.298182 14.362065 307.898182 14.362065 512c0 282.298182 238.824727 512 532.38691 512a522.286545 522.286545 0 0 0 453.957818-268.334545A69.818182 69.818182 0 0 0 991.816611 674.909091zM546.679156 954.181818c-248.785455 0-462.941091-192-462.941091-442.181818 0-186.647273 140.637091-372.829091 300.939637-442.181818-36.817455 65.629091-92.578909 151.970909-92.578909 232.727273 0 250.181818 214.109091 465.454545 462.917818 465.454545a488.331636 488.331636 0 0 0 185.181091-46.545455 453.003636 453.003636 0 0 1-393.565091 232.727273z m103.656728-669.323636l-14.266182 83.781818a34.909091 34.909091 0 0 0 50.362182 36.770909l74.775272-39.563636 74.752 39.563636a36.142545 36.142545 0 0 0 16.174546 3.956364 34.909091 34.909091 0 0 0 34.210909-40.727273l-14.289455-83.781818 60.509091-59.345455a35.025455 35.025455 0 0 0-19.223272-59.578182l-83.61891-12.101818-37.376-76.101818a34.56 34.56 0 0 0-62.254545 0l-37.376 76.101818-83.618909 12.101818a34.909091 34.909091 0 0 0-19.246546 59.578182z m70.423272-64.698182a34.280727 34.280727 0 0 0 26.135273-19.083636l14.312727-29.090909 14.336 29.090909a34.257455 34.257455 0 0 0 26.135273 19.083636l32.046546 4.887273-23.272728 22.574545a35.234909 35.234909 0 0 0-10.007272 30.952727l5.46909 32.116364-28.625454-15.127273a34.490182 34.490182 0 0 0-32.302546 0l-28.695272 15.127273 5.469091-32.116364a35.141818 35.141818 0 0 0-9.984-30.952727l-23.272728-22.574545z" p-id="3855"></path></svg></button><button title="Light theme" class="__dumi-default-dark-sun "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4026" width="22" height="22"><path d="M915.2 476.16h-43.968c-24.704 0-44.736 16-44.736 35.84s20.032 35.904 44.736 35.904H915.2c24.768 0 44.8-16.064 44.8-35.904s-20.032-35.84-44.8-35.84zM512 265.6c-136.704 0-246.464 109.824-246.464 246.4 0 136.704 109.76 246.464 246.464 246.464S758.4 648.704 758.4 512c0-136.576-109.696-246.4-246.4-246.4z m0 425.6c-99.008 0-179.2-80.128-179.2-179.2 0-98.944 80.192-179.2 179.2-179.2S691.2 413.056 691.2 512c0 99.072-80.192 179.2-179.2 179.2zM197.44 512c0-19.84-19.136-35.84-43.904-35.84H108.8c-24.768 0-44.8 16-44.8 35.84s20.032 35.904 44.8 35.904h44.736c24.768 0 43.904-16.064 43.904-35.904zM512 198.464c19.776 0 35.84-20.032 35.84-44.8v-44.8C547.84 84.032 531.84 64 512 64s-35.904 20.032-35.904 44.8v44.8c0 24.768 16.128 44.864 35.904 44.864z m0 627.136c-19.776 0-35.904 20.032-35.904 44.8v44.736C476.096 940.032 492.16 960 512 960s35.84-20.032 35.84-44.8v-44.736c0-24.768-16.064-44.864-35.84-44.864z m329.92-592.832c17.472-17.536 20.288-43.072 6.4-57.024-14.016-14.016-39.488-11.2-57.024 6.336-4.736 4.864-26.496 26.496-31.36 31.36-17.472 17.472-20.288 43.008-6.336 57.024 13.952 14.016 39.488 11.2 57.024-6.336 4.8-4.864 26.496-26.56 31.296-31.36zM213.376 759.936c-4.864 4.8-26.56 26.624-31.36 31.36-17.472 17.472-20.288 42.944-6.4 56.96 14.016 13.952 39.552 11.2 57.024-6.336 4.8-4.736 26.56-26.496 31.36-31.36 17.472-17.472 20.288-43.008 6.336-56.96-14.016-13.952-39.552-11.072-56.96 6.336z m19.328-577.92c-17.536-17.536-43.008-20.352-57.024-6.336-14.08 14.016-11.136 39.488 6.336 57.024 4.864 4.864 26.496 26.56 31.36 31.424 17.536 17.408 43.008 20.288 56.96 6.336 14.016-14.016 11.264-39.488-6.336-57.024-4.736-4.864-26.496-26.56-31.296-31.424z m527.168 628.608c4.864 4.864 26.624 26.624 31.36 31.424 17.536 17.408 43.072 20.224 57.088 6.336 13.952-14.016 11.072-39.552-6.4-57.024-4.864-4.8-26.56-26.496-31.36-31.36-17.472-17.408-43.072-20.288-57.024-6.336-13.952 14.016-11.008 39.488 6.336 56.96z" p-id="4027"></path></svg></button><button title="Default to system" class="__dumi-default-dark-auto "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="11002" width="22" height="22"><path d="M127.658667 492.885333c0-51.882667 10.24-101.717333 30.378666-149.162666s47.786667-88.064 81.92-122.538667 75.093333-61.781333 122.538667-81.92 96.938667-30.378667 149.162667-30.378667 101.717333 10.24 149.162666 30.378667 88.405333 47.786667 122.88 81.92 61.781333 75.093333 81.92 122.538667 30.378667 96.938667 30.378667 149.162666-10.24 101.717333-30.378667 149.162667-47.786667 88.405333-81.92 122.88-75.093333 61.781333-122.88 81.92-97.28 30.378667-149.162666 30.378667-101.717333-10.24-149.162667-30.378667-88.064-47.786667-122.538667-81.92-61.781333-75.093333-81.92-122.88-30.378667-96.938667-30.378666-149.162667z m329.045333 0c0 130.048 13.994667 244.394667 41.984 343.381334h12.970667c46.762667 0 91.136-9.216 133.461333-27.306667s78.848-42.666667 109.568-73.386667 54.954667-67.242667 73.386667-109.568 27.306667-86.698667 27.306666-133.461333c0-46.421333-9.216-90.794667-27.306666-133.12s-42.666667-78.848-73.386667-109.568-67.242667-54.954667-109.568-73.386667-86.698667-27.306667-133.461333-27.306666h-11.605334c-28.672 123.562667-43.349333 237.909333-43.349333 343.722666z" p-id="11003"></path></svg></button></div></div></div><ul class="__dumi-default-menu-list"><li><a href="/blog-base/sql必知必会">sql必知必会</a></li><li><a href="/blog-base/sql必知必会/01.开篇词">01.开篇词</a><ul><li><a href="/blog-base/sql必知必会/01.开篇词/01"><span>开篇词丨SQL可能是你掌握的最有用的技能</span></a></li></ul></li><li><a href="/blog-base/sql必知必会/02.第一章sql语法基础篇">02.第一章SQL语法基础篇</a><ul><li><a href="/blog-base/sql必知必会/02.第一章sql语法基础篇/01"><span>01丨了解SQL：一门半衰期很长的语言</span></a></li><li><a href="/blog-base/sql必知必会/02.第一章sql语法基础篇/02"><span>02丨DBMS的前世今生</span></a></li><li><a href="/blog-base/sql必知必会/02.第一章sql语法基础篇/03"><span>03丨学会用数据库的方式思考SQL是如何执行的</span></a></li><li><a href="/blog-base/sql必知必会/02.第一章sql语法基础篇/04"><span>04丨使用DDL创建数据库&amp;数据表时需要注意什么？</span></a></li><li><a href="/blog-base/sql必知必会/02.第一章sql语法基础篇/05"><span>05丨检索数据：你还在SELECT * 么？</span></a></li><li><a href="/blog-base/sql必知必会/02.第一章sql语法基础篇/06"><span>06丨数据过滤：SQL数据过滤都有哪些方法？</span></a></li><li><a href="/blog-base/sql必知必会/02.第一章sql语法基础篇/07"><span>07丨什么是SQL函数？为什么使用SQL函数可能会带来问题？</span></a></li><li><a href="/blog-base/sql必知必会/02.第一章sql语法基础篇/08"><span>08丨什么是SQL的聚集函数，如何利用它们汇总表的数据？</span></a></li><li><a href="/blog-base/sql必知必会/02.第一章sql语法基础篇/09"><span>09丨子查询：子查询的种类都有哪些，如何提高子查询的性能？</span></a></li><li><a href="/blog-base/sql必知必会/02.第一章sql语法基础篇/10"><span>10丨常用的SQL标准有哪些，在SQL92中是如何使用连接的？</span></a></li><li><a href="/blog-base/sql必知必会/02.第一章sql语法基础篇/11"><span>11丨SQL99是如何使用连接的，与SQL92的区别是什么？</span></a></li><li><a href="/blog-base/sql必知必会/02.第一章sql语法基础篇/12"><span>12丨视图在SQL中的作用是什么，它是怎样工作的？</span></a></li><li><a href="/blog-base/sql必知必会/02.第一章sql语法基础篇/13"><span>13丨什么是存储过程，在实际项目中用得多么？</span></a></li><li><a href="/blog-base/sql必知必会/02.第一章sql语法基础篇/14"><span>14丨什么是事务处理，如何使用COMMIT和ROLLBACK进行操作？</span></a></li><li><a href="/blog-base/sql必知必会/02.第一章sql语法基础篇/15"><span>15丨初识事务隔离：隔离的级别有哪些，它们都解决了哪些异常问题？</span></a></li><li><a href="/blog-base/sql必知必会/02.第一章sql语法基础篇/16"><span>16丨游标：当我们需要逐条处理数据时，该怎么做？</span></a></li><li><a href="/blog-base/sql必知必会/02.第一章sql语法基础篇/17"><span>17丨如何使用Python操作MySQL？</span></a></li><li><a href="/blog-base/sql必知必会/02.第一章sql语法基础篇/18"><span>18丨SQLAlchemy：如何使用Python ORM框架来操作MySQL？</span></a></li><li><a href="/blog-base/sql必知必会/02.第一章sql语法基础篇/19"><span>19丨基础篇总结：如何理解查询优化、通配符以及存储过程？</span></a></li></ul></li><li><a href="/blog-base/sql必知必会/03.第二章sql性能优化篇">03.第二章SQL性能优化篇</a><ul><li><a href="/blog-base/sql必知必会/03.第二章sql性能优化篇/01"><span>20丨当我们思考数据库调优的时候，都有哪些维度可以选择？</span></a></li><li><a href="/blog-base/sql必知必会/03.第二章sql性能优化篇/02"><span>21丨范式设计：数据表的范式有哪些，3NF指的是什么？</span></a></li><li><a href="/blog-base/sql必知必会/03.第二章sql性能优化篇/03"><span>22丨反范式设计：3NF有什么不足，为什么有时候需要反范式设计？</span></a></li><li><a href="/blog-base/sql必知必会/03.第二章sql性能优化篇/04"><span>23丨索引的概览：用还是不用索引，这是一个问题</span></a></li><li><a href="/blog-base/sql必知必会/03.第二章sql性能优化篇/05"><span>24丨索引的原理：我们为什么用B+树来做索引？</span></a></li><li><a href="/blog-base/sql必知必会/03.第二章sql性能优化篇/06"><span>25丨Hash索引的底层原理是什么？</span></a></li><li><a href="/blog-base/sql必知必会/03.第二章sql性能优化篇/07"><span>26丨索引的使用原则：如何通过索引让SQL查询效率最大化？</span></a></li><li><a href="/blog-base/sql必知必会/03.第二章sql性能优化篇/08"><span>27丨从数据页的角度理解B+树查询</span></a></li><li><a href="/blog-base/sql必知必会/03.第二章sql性能优化篇/09"><span>28丨从磁盘I/O的角度理解SQL查询的成本</span></a></li><li><a href="/blog-base/sql必知必会/03.第二章sql性能优化篇/10"><span>29丨为什么没有理想的索引？</span></a></li><li><a href="/blog-base/sql必知必会/03.第二章sql性能优化篇/11"><span>30丨锁：悲观锁和乐观锁是什么？</span></a></li><li><a href="/blog-base/sql必知必会/03.第二章sql性能优化篇/12"><span>31丨为什么大部分RDBMS都会支持MVCC？</span></a></li><li><a href="/blog-base/sql必知必会/03.第二章sql性能优化篇/13"><span>32丨查询优化器是如何工作的？</span></a></li><li><a href="/blog-base/sql必知必会/03.第二章sql性能优化篇/14"><span>33丨如何使用性能分析工具定位SQL执行慢的原因？</span></a></li><li><a href="/blog-base/sql必知必会/03.第二章sql性能优化篇/15"><span>34丨答疑篇：关于索引以及缓冲池的一些解惑</span></a></li><li><a href="/blog-base/sql必知必会/03.第二章sql性能优化篇/16"><span>35丨数据库主从同步的作用是什么，如何解决数据不一致问题？</span></a></li><li><a href="/blog-base/sql必知必会/03.第二章sql性能优化篇/17"><span>36丨数据库没有备份，没有使用Binlog的情况下，如何恢复数据？</span></a></li><li><a href="/blog-base/sql必知必会/03.第二章sql性能优化篇/18"><span>37丨SQL注入：你的SQL是如何被注入的？</span></a></li></ul></li><li><a aria-current="page" class="active" href="/blog-base/sql必知必会/04.第三章认识dbms">04.第三章认识DBMS</a><ul><li><a href="/blog-base/sql必知必会/04.第三章认识dbms/01"><span>38丨如何在Excel中使用SQL语言？</span></a></li><li><a href="/blog-base/sql必知必会/04.第三章认识dbms/02"><span>39丨WebSQL：如何在H5中存储一个本地数据库？</span></a></li><li><a href="/blog-base/sql必知必会/04.第三章认识dbms/03"><span>40丨SQLite：为什么微信用SQLite存储聊天记录？</span></a></li><li><a href="/blog-base/sql必知必会/04.第三章认识dbms/04"><span>41丨初识Redis：Redis为什么会这么快？</span></a></li><li><a href="/blog-base/sql必知必会/04.第三章认识dbms/05"><span>42丨如何使用Redis来实现多用户抢票问题</span></a></li><li><a aria-current="page" class="active" href="/blog-base/sql必知必会/04.第三章认识dbms/06"><span>43丨如何使用Redis搭建玩家排行榜？</span></a></li><li><a href="/blog-base/sql必知必会/04.第三章认识dbms/07"><span>44丨DBMS篇总结和答疑：用SQLite做词云</span></a></li></ul></li><li><a href="/blog-base/sql必知必会/05.第四章sql项目实战">05.第四章SQL项目实战</a><ul><li><a href="/blog-base/sql必知必会/05.第四章sql项目实战/01"><span>45丨数据清洗：如何使用SQL对数据进行清洗？</span></a></li><li><a href="/blog-base/sql必知必会/05.第四章sql项目实战/02"><span>46丨数据集成：如何对各种数据库进行集成和转换？</span></a></li><li><a href="/blog-base/sql必知必会/05.第四章sql项目实战/03"><span>47丨如何利用SQL对零售数据进行分析？</span></a></li></ul></li><li><a href="/blog-base/sql必知必会/06.结束语">06.结束语</a><ul><li><a href="/blog-base/sql必知必会/06.结束语/01"><span>结束语 | 互联网的下半场是数据驱动的时代</span></a></li></ul></li><li><a href="/blog-base/sql必知必会/07.期末考试">07.期末考试</a><ul><li><a href="/blog-base/sql必知必会/07.期末考试/01"><span>期末测试丨对于SQL的有关内容，你掌握了多少呢？</span></a></li></ul></li><li><a href="/blog-base/sql必知必会/summary">sql必知必会</a></li></ul></div></div><ul role="slug-list" class="__dumi-default-layout-toc"><li title="使用MySQL搭建玩家排行榜" data-depth="2"><a href="/blog-base/sql必知必会/04.第三章认识dbms/06#使用mysql搭建玩家排行榜"><span>使用MySQL搭建玩家排行榜</span></a></li><li title="王者荣耀英雄等级说明" data-depth="3"><a href="/blog-base/sql必知必会/04.第三章认识dbms/06#王者荣耀英雄等级说明"><span>王者荣耀英雄等级说明</span></a></li><li title="使用存储过程模拟10万名玩家数据" data-depth="3"><a href="/blog-base/sql必知必会/04.第三章认识dbms/06#使用存储过程模拟10万名玩家数据"><span>使用存储过程模拟10万名玩家数据</span></a></li><li title="Lua是什么，如何在Redis中使用" data-depth="2"><a href="/blog-base/sql必知必会/04.第三章认识dbms/06#lua是什么如何在redis中使用"><span>Lua是什么，如何在Redis中使用</span></a></li><li title="如何在Redis中使用Lua" data-depth="3"><a href="/blog-base/sql必知必会/04.第三章认识dbms/06#如何在redis中使用lua"><span>如何在Redis中使用Lua</span></a></li><li title="使用Lua创建10万名玩家数据" data-depth="2"><a href="/blog-base/sql必知必会/04.第三章认识dbms/06#使用lua创建10万名玩家数据"><span>使用Lua创建10万名玩家数据</span></a></li><li title="使用Redis实现玩家排行榜" data-depth="3"><a href="/blog-base/sql必知必会/04.第三章认识dbms/06#使用redis实现玩家排行榜"><span>使用Redis实现玩家排行榜</span></a></li><li title="统计全部玩家的排行榜" data-depth="3"><a href="/blog-base/sql必知必会/04.第三章认识dbms/06#统计全部玩家的排行榜"><span>统计全部玩家的排行榜</span></a></li><li title="按名次查询排名前N名的玩家" data-depth="3"><a href="/blog-base/sql必知必会/04.第三章认识dbms/06#按名次查询排名前n名的玩家"><span>按名次查询排名前N名的玩家</span></a></li><li title="查询某个玩家的分数" data-depth="3"><a href="/blog-base/sql必知必会/04.第三章认识dbms/06#查询某个玩家的分数"><span>查询某个玩家的分数</span></a></li><li title="查询某个玩家的排名" data-depth="3"><a href="/blog-base/sql必知必会/04.第三章认识dbms/06#查询某个玩家的排名"><span>查询某个玩家的排名</span></a></li><li title="对玩家的分数进行更新，同时排名进行更新" data-depth="3"><a href="/blog-base/sql必知必会/04.第三章认识dbms/06#对玩家的分数进行更新同时排名进行更新"><span>对玩家的分数进行更新，同时排名进行更新</span></a></li><li title="查询指定玩家前后M名的玩家" data-depth="3"><a href="/blog-base/sql必知必会/04.第三章认识dbms/06#查询指定玩家前后m名的玩家"><span>查询指定玩家前后M名的玩家</span></a></li><li title="总结" data-depth="2"><a href="/blog-base/sql必知必会/04.第三章认识dbms/06#总结"><span>总结</span></a></li></ul><div class="__dumi-default-layout-content"><div class="markdown"><h1 id="43丨如何使用redis搭建玩家排行榜"><a aria-hidden="true" tabindex="-1" href="/blog-base/sql必知必会/04.第三章认识dbms/06#43丨如何使用redis搭建玩家排行榜"><span class="icon icon-link"></span></a>43丨如何使用Redis搭建玩家排行榜？</h1><p>上一篇文章中，我们使用Redis模拟了多用户抢票的问题，这里再回顾一下原理。我们通过使用WATCH+MULTI的方式实现乐观锁机制，对ticket_count这个键进行监视，当这个键发生变化的时候事务就会被打断，重新请求，这样做的好处就是可以保证事务对键进行操作的原子性，当然我们也可以使用Redis的incr和decr来实现键的原子性递增或递减。</p><p>今天我们用Redis搭建一个玩家的排行榜，假设一个服务器存储了10万名玩家的数据，我们想给这个区（这台服务器）上的玩家做个全区的排名，该如何用Redis实现呢？</p><p>不妨一起来思考下面几个问题：</p><ol><li>MySQL是如何实现玩家排行榜的？有哪些难题需要解决？</li><li>如何用Redis模拟10万名玩家数据？Redis里的Lua又是什么？</li><li>Redis如何搭建玩家排行榜？和MySQL相比有什么优势？</li></ol><h2 id="使用mysql搭建玩家排行榜"><a aria-hidden="true" tabindex="-1" href="/blog-base/sql必知必会/04.第三章认识dbms/06#使用mysql搭建玩家排行榜"><span class="icon icon-link"></span></a>使用MySQL搭建玩家排行榜</h2><p>我们如果用MySQL搭建玩家排行榜的话，首先需要生成10万名玩家的数据，这里我们使用之前学习过的存储过程来模拟。</p><p>为了简化，玩家排行榜主要包括3个字段：user_id、score、和create_time，它们分别代表玩家的用户ID、玩家的积分和玩家的创建时间。</p><h3 id="王者荣耀英雄等级说明"><a aria-hidden="true" tabindex="-1" href="/blog-base/sql必知必会/04.第三章认识dbms/06#王者荣耀英雄等级说明"><span class="icon icon-link"></span></a>王者荣耀英雄等级说明</h3><p>这里我们可以模拟王者荣耀的英雄等级，具体等级标准如下：</p><p><img src="/blog-base/static/httpsstatic001geekbangorgresourceimagef14df10fb49dde602525a65270c6b2af884d.1628bbf3.png" alt=""/><br/>如果想要英雄要达到最强王者的段位，那么之前需要积累112颗（9+12+16+25+25+25）星星，而达到最强王者之后还可以继续积累无上限的星星。在随机数模拟上，我们也分成两个阶段，第一个阶段模拟英雄的段位，我们使用随机数来模拟score（数值范围是1-112之间），当score=112的时候，再模拟最强王者等级中的星星个数。如果我们只用一个随机数进行模拟，会出现最强王者的比例变大的情况，显然不符合实际情况。</p><h3 id="使用存储过程模拟10万名玩家数据"><a aria-hidden="true" tabindex="-1" href="/blog-base/sql必知必会/04.第三章认识dbms/06#使用存储过程模拟10万名玩家数据"><span class="icon icon-link"></span></a>使用存储过程模拟10万名玩家数据</h3><p>这里我们使用存储过程，具体代码如下：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">CREATE DEFINER=`root`@`localhost` PROCEDURE `insert_many_user_scores`(IN START INT(10), IN max_num INT(10))</span></div><div class="token-line"><span class="token plain">    BEGIN</span></div><div class="token-line"><span class="token plain">    DECLARE i INT DEFAULT 0;</span></div><div class="token-line"><span class="token plain">    -- 模拟玩家英雄的星星数</span></div><div class="token-line"><span class="token plain">    DECLARE score INT;</span></div><div class="token-line"><span class="token plain">    DECLARE score2 INT;</span></div><div class="token-line"><span class="token plain">    -- 初始注册时间</span></div><div class="token-line"><span class="token plain">    DECLARE date_start DATETIME DEFAULT (&#x27;2017-01-01 00:00:00&#x27;);</span></div><div class="token-line"><span class="token plain">    -- 每个玩家的注册时间</span></div><div class="token-line"><span class="token plain">    DECLARE date_temp DATETIME;</span></div><div class="token-line"><span class="token plain">    SET date_temp = date_start;</span></div><div class="token-line"><span class="token plain">    SET autocommit=0;</span></div><div class="token-line"><span class="token plain">     </span></div><div class="token-line"><span class="token plain">    REPEAT</span></div><div class="token-line"><span class="token plain">    SET i=i+1;</span></div><div class="token-line"><span class="token plain">    SET date_temp = date_add(date_temp, interval RAND()*60 second);</span></div><div class="token-line"><span class="token plain">    -- 1-112随机数</span></div><div class="token-line"><span class="token plain">    SET score = CEIL(RAND()*112);</span></div><div class="token-line"><span class="token plain">    -- 如果达到了王者，继续模拟王者的星星数</span></div><div class="token-line"><span class="token plain">    IF score = 112 THEN</span></div><div class="token-line"><span class="token plain">               SET score2 = FLOOR(RAND()*100);</span></div><div class="token-line"><span class="token plain">               SET score = score + score2;</span></div><div class="token-line"><span class="token plain">    END IF;</span></div><div class="token-line"><span class="token plain">    -- 插入新玩家</span></div><div class="token-line"><span class="token plain">    INSERT INTO user_score(user_id, score, create_time) VALUES((START+i), score, date_temp); </span></div><div class="token-line"><span class="token plain">    UNTIL i = max_num</span></div><div class="token-line"><span class="token plain">    END REPEAT;</span></div><div class="token-line"><span class="token plain">    COMMIT;</span></div><div class="token-line"><span class="token plain">    END</span></div></pre></div><p>然后我们使用<code>call insert_many_user_scores(10000,100000);</code>模拟生成10万名玩家的得分数据。注意在insert之前，需要先设置<code>autocommit=0</code>，也就是关闭了自动提交，然后在批量插入结束之后再手动进行COMMIT，这样做的好处是可以进行批量提交，提升插入效率。你可以看到整体的用时为5.2秒。</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABQgAAABqCAMAAADHukyqAAAAIGNIUk0AAHomAACAhAAA+gAAAIDoAAB1MAAA6mAAADqYAAAXcJy6UTwAAAECUExURdzu/sze7nqMnFpse1BfbBYbHgUGBwAAAAEBAQYGBgwMDAkJCQMDAwsLCzAwMFpaWmBgYEhISBgYGFRUVBUVFZ6enqioqH5+fioqKgoKCpOTkxYWFqmpqbS0tLW1tbq6ur6+vsDAwJCQkGZmZiMjI7e3tzk5Ob+/v729vba2ti0tLRISEoeHh3h4eEJCQiQkJJycnK6urpaWlhcXF2xsbKurq6qqqlZlcjo/QjIzNGJxfoKHioyNjmd3hKarrrm6u4qKijw8PDY2NoSEhCEhIZ+fn2Z1gp2ipa6vsFtreF5jZl9gYVJibygtMBwdHlBgbR8kJxESE2V0gZSZnKOkpf///5TXvA0AAAABYktHRFWTBLgzAAAAB3RJTUUH5wkXCAoeCbgInAAAAAFvck5UAc+id5oAACKOSURBVHja7V1pY+K6kr2zGjvggElIQocQyNI0ZG/S772ZefN6uXf2feb//5aRXNqqLFm2WUIanW+dg1RSWT7t0la//PLLn/35X/zlX/11FBAQELCn+CUIYUBAwL4jCGFAQMDeIwhhQEDA3iMIYUBAwN4jCGFAQMDeIwhhQEDA3iMIYUBAwN4jCGFAQMDeIwhhQEDA3iMIYUBAwN4jCGFAQMDeIwhhQEDA3iMIYUBAwN5jq0LYihONg3aBiFtvaLxI+NDu1C0REGCidcBHUCfGf20fJB0yqGCoKegSayQ8eKNWeYjOut6+rQphkh52FXoZJQ7T5O2MWwgP4qxfs0RAAELS4yOon2IxynrdPh5UYqgpqBJrJHzIWxVvu1U+or+ut2+rQnjUPx4onJxS4rh/9HbGLYQHZ6fDmiUCAhCOTvgIGvbP0F9PTwZDPKjEUFNQJdZI+JC36mzbrfIRw3W9fVsVwg+H56PR6GJ8OWGYpohgfx1dXScHG4uOhfEbm3E74UGSDmqWWBvizgYdFbAdsFjzeji5vLk4PuwYf+0kt8PJwBxUcSe7Pf84+zQCfJp9PL/KklgQkzUQ3rEkW5WQVk1mN4WqKDH2Eu3aRBR15sejm9nk/HZN0fFWhXDRu5tOp8PBmAoII9hfb+4f5o9VpyyaGn+yGbcTHrydELaz0w06KmA7SB7Th6fJ+Gl40jtQf2wnp2n/CQkhe9q3/efZ6GUKeBnNnu9v51kbiMkaCO9Ykq1KSKsmoydaVYEYeImkLsHsHzyeTJ9Gk+d+epqsQwm3KoTt5HOWZdfLVyogjGB/vRy9Hp9sLDoWxh9sxu2EB28nhGf94QYdFbAdsFjzdTx5fbg+SvQXGY/4nsdICNnT/vI8u3iZZ4D5y8Vs9OW4fwbEZA2EdyzJViWkVZOXB1pVgVh6idO6RMSXOI+yh5fJ7JkG7A3xBttnkq5NQDqHxzw6Hl5vdhnWqV71ZY1/nDPczbfmOQCLMK7OR9OwRvOeAbHm5c3oeC7j4pgvg/JQkMEUQnhfxANv8Xh6xP/dTeSLtDpRMpbyViWyVQlplXhfzKoKxJWXSOsSog3zOxaRs+g4s6y711wT3x0hPOid8Oj46SF93Oza8dqEkH+cMywft+a5HDzCuH8OQviuISLg8dP05FHExey5pmnKQ8EyIYx5PH1jkbUSYu4l3GMJWpXKVjmE0KyqQNx7ibQuIdrwuGQROYuOb08z/PGUPKYASrixM0LYSo54dDx+3ewy7BqFkH+cMyy2PFnHI4zRLAjhu4aIgF8fsiO5UsGe62Aw4KFgmRAe8Xj60iJrJcSxl3CPJWjVQLbKIYRmVQVi5CXSuoRoQ7xgETmLjr9Y1t1rronvjhCWEes0vj4hfCOg9yLgfUKMtqLeCTiFMJuKX1BZKyFGXsI9lkirHEJoVtWASOsSun3Q7UEXR5GpdAYl3AAh/N3v/5ASqAA1zubsn2JlKck/lGGdBgj5c+O7SBF8adMsYXGhCR4dP40nT/0K0TE2nlQg0AhcTQjbVhvIMjHedrVKhB6uqqgHGcHiYtZOPocgvv7LF81oq8wSHuPq57S5Ysk6fvRFH9Bt8XOIV+zGT10uMX4uW8Vd8lih586q6hP6r8xLCe52O3FVVUKIxdATY1qFjX69ecEuhLDObJG1cuLGS7iFEFo1la2yCSGpqgGReonY1dzFUqxXo2HYWAj/5m//bkqgpr5gd8ldb8H/AdNiMK8BhPz5wmicJO7YX80S1IXFYSsGiH/eDRt/rEAI4+sQwgOrDWSZGD9wtUoMNFdV1IOwz4i1U++mMF3rcxQp4TGufk6bewdPmw1CTvfc9qHb4uePS7fxE5dLjJ/LVnGXLCv03FlVfUL/lXnpEXdbTBVbqiohxH/4Rf0vnSOEOTGLrJUTMy+x0hwhqaoBkXqJhau5oJDjAdqD1FwI//j3f5oQKEXIusZSjfyiTxQhf25+rkqCPzyzBHVhEZXlCBtPKxAeA3WEMLHaQJZJVYmrVSj0KFZFPUhtENf6HEVKeIyrn9PmojCtbKxBt8XPYXTajZfEiIlZlRhqpKoS++WBXVVC/5V5KcXdFgPHUpWHKHsB7D5X7/eEyNqqhHeapewtJlU1IFIvkZU0F2JmNAxXFMLZYMg+N/i3hvz/qh25hBDWcGaDF/E5r1Z7TeLr/bdUxgAVvggjtU3yqXybJAvesHEjmFbfM5b/dKO1fhHSLdjgKGgV8mAez964iGcLoT78tBDytbGkXf+LULWKN5c9iSdjmU1/6Jg+FyXAANmzui4hbEPPizaKxC0QB7Ln+jW2LBeagOV1S1W1COkofQxAGM+jMbTZ2SyBCLK0uYoQjp/EpxGVtRJi6CVWFUKzqgIx8BKpl8gwgUd4UQjho90TrmCYQnhzf8vGAZ99MtXLLoSL5R1r1s39g/icZ08cYiuT+N77gd5v6kLL4IVtBUQ6KZgcYONGMK1muCzTMNFa5whFFEOEEFqFPJir18xFjC2EmgrUQshPIDwe1J8jVK3izWVPom8cZtBTX6bPRQkwQPZ4rEsIQdYsNorEEIi27LkWQnIog0JvyCJV1SKko6RxKYQQjcG0tqUEIsgBklWEkP2PYdkMU07ceolVhdCsqkDce4nUS2SYwCO8KISNt8+AEIKn7NEYFUKwDn+1LO5YCIsLHU73xj1mk3zKNkhtf13HqjEt4ZlDqEPg4S8jLOBqrhorG7y5xcDO4vPMG8+uLoT1CWPgZNVCH9RWbKMG0SXGU2TcWaLMUasI4SBVbxiWtRIi8RKrCqFZVYHoeonUS2SYwCO8KIQN0FQIYVfPxXL+OWmja1hWE0JxcGZcfnDGbBK9AwYOzOkzczsghEf94y/gq0U7kpdmnKkSjODtlc1FLx4/WPXthW8524QQtpIjcXiJ+XyrQnjGXZIfG+MuOdEugRLiPJnZKj1wuEt+iE1zZcZhw6XVhtEJJ2EXwpcHZFw/Jd3cbhKZ5+IWMb1kppEQ8qqYAYveeYnESzQXQuYPUlWB6HqJ1EvMX3ZVCNVU4F1vIfYJwDTdakJYbY7QbBIyHpE5wt0QQjVHyJdPzc0wdFax+NbzSSY+0fq0ESFEc4RbFUI9FchdYmyGScgEpUUIuUt6Ig4sM65n/Ao2jE44CbsQjp6Qcf2UdHO7SWTOES4f6T6jRkKYT92PbHrnJRIv0VwIYdbZIoSa6HqJ1Eu8jHZVCOHk38fxp/PDD+iq5tWEUFyuMyy/XAc1idwTDZdq6Xu1dkAIW3GSga/uPqCLdaEEI3h7ZXPRi8cvX/r6Kz+Wugkh7BweiwuObmaFB75RIYy4S/KrpbhLDrRLoIS4c+pmZjHOL5H6+l2cbS0d/vmhbKsNoxNOwi6EsxtkXD8l3Vwooe7OupvTi6gbCSGvihmw6J2XSLxEcyFk/iBVFYiul0i9xKfZrgphJC80/a17mh80k0K0ghDyU3YsQGRxseeUnd0hUR4Xz5cXl6NX+2Gl6G2EMMpDQe6rH6foUB6UgObKM0FyRgC8lB85PHLHb344hVDc+DPOjZux91aEUB3eApccxaiEaJXVJRM4hXl0cuw/QkVstCydwM31CiEMTmVcPyXn1aE/viHjQIhLVY4KxzNLj5zkM0YFvfMSZ16iuRAWqyoQXS+ReokZJnTD2gtx7w0aCfFCTPmYF/uUYwUhhPXZ790fYperePGaC2HlkyVOIaTLyTsjhLDOzFfRza3LaJ2ZrAGDl/JLKGJ3/OaHUwgXZH1220IolqzBJWptPzGXrK0uETu14se5f1WQ2LAtfePmeoUQBqcyrp+Sbi45ctK7p5uc7CdL0KCyCyHsBrPIWjnR9hIrCSGpqkB0vUTqJZ4xoRtmP1my4vaZmkIISY8+d3/LL6P6IF+85kLIb+JiASKLiz03cTmFkMXFn8Yf+U3X1guNojcTwgh89f03dHGXKJE3V94bJHsuXsphfmm3M37zwymE4lbwYW7cjL23JITigidwyfEclxi6XTKBm9rseY8osI2OpRO4uV4hhMGpjOun5Ewv9P0rMg6EuHhZdZsOKrsQwoyRRdZWJVYSQlJVgeh6idRLnGNCN+zDnbgbG42E+Z2Y8kGXf5fCL4RqzVMsbcLna3vBF2f5krG66xEivqZCWOf2GdMh6A4Yy76aHRBCWMgWy+syJmrREtCPOvEbBABH5RetO4XQqXdZeTyrLwm13/yB2+qoqgUugVV08xoWVIJ0EF0Z4AesiZs2rqWNgd1Gte0z9oehq8qjMcN4yf2r5u0zaFAVhVC/GVTW1kCo61zkLgI6qJxCqOaxqBBqouslUi8xxIRsruv2mRVPltiFMEkPr6bj8XTJk0bdjyaDe57NKumJvHNx2r/if12KdG5NhZDXMx2NVT1lMB2CcsntphCqHH28rcqDtITMyhWbXioVwqyHSnh8tRYhhKfNnxLDcjAZ3V+VpUFzCmEMLuklvNv3vB7RD1SCdLCmELK2EhtX0sbAbmNFIcyMnHSG8Z7FUTHpNh1URSEcF94wKWtrIKRHVco4OqicQsjGMqmqQHS9ROol+oXXWzjcPgY3IoRqzVMsbcLn64c7vjjLl4xVPhiI+JoKYZ0bqk2HoHuid1MIYSFbLK/LmKhDS0A/6sRvEACgoKvEV2sRQpRIyH47MG6ro6oOuARW0c2rmlEJ0sGaQghr4qaNC2ljYLexohCKqvJozDBekqMJ3VBtDirLhmr1ZlBZWwOhrnyWuwjooHIKoZrHokKoia6XSL1EBxOyua4bqlcXQvb8+MMj/e4U87wxIUSzcUoIKWEOHphVzK7ORffUBFALdlPABhM/6FQgUxZh3CD4hJyZ5koYv7UZtxNuWEuUCeGFbBUSQp28jxDgDzn8cZSi/8dgb9LsprIQ8v8xmJfsc4Tfv4Kv+JAqFUL1P89N4apOCzrEhhq2HTJBqRShSAj1imI1cCpmc9COIlXVIkC98p046G3VNm5sJRBhEcKo+BqbV/Wf3+rpRlRVXtvocnxxftiRc+qrE/KlI4eYVKsS2aqMtEqMfrOqAnHlJeZ1Cd4A138l2rWrCCH7ouef80QIIZDhEbCSNRYaL2XAjEJjSphCCDHiFdywyD54dUzCw+8RK8SN+8F+jo3Lj2qTyCN5M+gyO0GM2wknYmuJstDYMrlgdttOyIAoIcblHALr3eC+cmjMo7FepoVQGB8gX/EgwyOEYi7iflBBCGNiQwUyiDCfUpG4MgkU2HmgHVWoqgaRagLFb9rGvauEZw6BBHYQTItBNbpHUbauKq9tPJpeHXInylmpVQn5EItCCK3qylZdkVaJ0W9WVSCmXiKrS0QlkwvatasIYSs54hO8RAhbxTxv7QXesacWSyhhCiHsPPwCF4uNn/UmsSM4cQWH0Pyg2wVfHqRxg+Cb9sw0V8L4s824nXDizFqibLHkWrYKLZao5H2UAH9M1D5CE3pV6XmsSzihWsVXlZiX7PsIf3wDX/FpZ48QitUpcvzNjhaxoaa2W2QTo1o1KBJiheNMumRSNZuDdhSpqhaRgPGhHrWmcdj6aimBiOJiCQeZ6kdX9c+e9ZZEVFVe2+Xr8vpz0pL7blcn5EtXFEJ0VT9rK2mVGP1mVQVi5CXiukRUstykXdtACP/hH/8pn8WS35hkviqvG08FRsYZDrR9Jioe7lBCiEqYkxF6Fq0qsPG5heBRtjkB5DFuIZzoWEugThAPdlzN1Yc7TMLpWlpIlYD43oJfu9i1xYksUY8iPqj5uyhyzEOSsMRpPImxjQ9W4+b2mSLh86AI3mzGW/aqnDZKjB87jKupAktVLsIYrC5/kM0fqKoNEXoC29nzN2iVjyhuQMq7cuCYjnADhPCf/+Vf83VNdeQBr2BG+kvYCEsgpBQw4zdF2ENjBDM6PUyryjc1nlkIsWJHbDiNWwgnYmsJ1AniwdjVXBF6EMLpWlrIXqII7dri0qaoRxGJWtGNIvvKNA1LnMYhGtM2Eqvx3IDDJTU9SPpsr8ppo8R43248UlMFlqpchDFYXf4QheQLiaraIKHiUHvP36hVZUTfOkniXE52A4Tw3/79P/KdbvIbk+xpi3Q+57k+IKbueUFH7KLiBTBKCFEJc8OS2mlXsdXUeGwheJRtbhLzGLcQTrSsJVAniAdbrubqC2BMwulaWkiVgPjegpfur8i1xc1uoh5FtNUeP/1z7A8aljiNH/Mg2LDRtho3j9gVCZ8HRfBmM35kr8ppo8T4kd14pKYKLFW5CGOwuvxBDoihqjZE6E2uzp6/Qat8xJFV6Kx7N8vhyWLXkpmS9fH1yoBg2lz+DtgYLPE9DX1WhoqA6bkIp/Hz9Rl3whK8SeM1BmsA2of2zlFpYxmGRwjhUCU/uasuNKoKkYppMvFdqhWwBlhyNNU9bemF8/Jvp/G79Rl3AqVbwsarD9YAmWvKnzftHaBqci8DHiGEazZgqVdccVkVIpieTHzXrAasAZb4nsQSq0NFwPTuFKfxz+sz7oQleJPGw3++NYDOqr5zVDp8iuERQpVV2X7KoQzORGEB7xSeBIEBAe8XHiFcLHXQc1cjLo5KUscGvFN4UkYHBLxfeIQQLpkRoUaNuDgqWZgLeKdwrtQHBLx3eIQwICAg4OdHEMKAgIC9RxDCgICAvUcQwoCAgL1HEMKAgIC9RxDCgICAvUcQwoCAgL1HEMKAgIC9RxDCgICAvUcQwoCAgL1HEMKAgIC9RxDCgICAvUcQwoCAgL2HKYQ6LUS9e2Y2C0uCDpSXJGp0D6MBeq3o0fu9V8XiKw+xrYap1BN1npL5XFu1M8tEVVOTbPt2pJ/pCtSfBqYQ6kRhldKsbwllKdvKUq1VBs3B1q91/+xOweIrD7GthqlkZHWekvlc49q5BqOqyepWGDurOONtnkSAHaYQ6tSxdXI0bRqWJL4od3HUKFeLAZp66Pj9pq+x+MpDbKthKj1tnadkPtdO7ezTUdX0xSuMnVWc8VOkSfppoISwFSfZ1ejj+BPPyj68Tg52IjrOW3UuW3UrWsWk69P4o84ekE4bpwNgBq7zbos34mY2OX+vSffijsg1yDqBMgc6iUZod5KDuoEkf/dvZrWekkwifwEileR5AngnKquX6rZ8rpnouUkwfJp95NzWvgmZM8Rwfp/j7KeEEkIWIF5Nx+PpkuZxf1PkrRrJVt2LVrG/LqfjtQghVMUMiBjJzFv+zsDCPe4r9uxYJwb3KEm3nWhmJusf1p46ESnh6zwlmUT+SiSRz4WQd6JqPKu7LZ/rlYyyDYJhORjXygW+KpgzxHB+x7MwPxuUEB71j7+MLi+Wc56Vffw6ODl966Zx5K2ayVY9i1a1k8/z5cVahJAZeM27LWbNH14ms3eadI+nDYRcg6wTZuZAJ9HMzOnw+OSoZiG+PsCM13lKMon8NSxkgBDyTlRd4dDdls/1C/QcEQzzlwvO9bf1zJkzxHAe7sRLFhBJIfzP//rvPEC8OD/8kEcxO/HhrsJW2SojsIOMalwIIYTK8403mOcR9XRzQYWq3mvSPUgbyF1C5kydRAOwqPL2vGY+Q4E6/13xJ3GOHmqiHnh9fxDjiGgfJNdDXvWgu8VnLobzu52F+fkAQvi73//h4f5mNhje9RY80fPTeBeyssfZPG/Vi2zVSLdKCWE7OU37T5BvvEGmPFMIRVXvXwhJfmsnUR/t7PS2/7xxIcyfxDN6qJsSwuQxfXi62bYQiuH8/PYvWQAAhPB//vf/8gDx+nPSzqOY113Iyq7CVtkqI7BTQngGIVSeb7zBXjBTCEVV718Iyb5KJ1EfPKp8nm1cCPMnMUMPdVNCeHoyeB1fblsIxXB+r7MwPyFACP/493/K5UAOhVTOa7cOEg6YRmbxCoNaTmaRq4ZaRxQleKGWowSM7Xb+w7LIAIWtER7MSggTaGvTfOPaRpsHfRXy0etuH8gOGuuzpkus3aY9jzuWEqVwlUDvtwkn4TZuEh2jH9kVd9FoeE05ewlEVJ51yMPvyewT2mBSXwhhi4zYYWUXQvYkoFUVhNDZwXZtAjC/G32Ctex3uDL308EjhPHjPE3TecYfI49XGB7lj1jkmio8yocJJfJCsb3EHBb7WEzCUBYZbFUIWVtZ0FdBCFW356zP0MFT+es2com126TnLNa0lCiDs0R9IXRWhYhTox+399xFN08PimuXlUBE1VkHCL8noxeURL6+EB70TqbT6d1ywf9hF0L2JKBVfiEkHdSjVgzyGoTA43L6wqPj29MsRMdvDo8QHp0cDwaD43xBjccrDGo5mUWuAwW1jggl8kJH9hKM4P9gMQlDWWSwVSFkbWVBXwUhVN3ma6fQQbX4d4ZcYu026TmLNS0lyuAsUV8InVUhYmj048uIu+hy/Kq4s7ISiKg66wDh9+Rljg6h1RdCOEYnTmHahZA9CWiVXwhJB/WoFYO8BiEQL7I5rGVvbb06wAmPEGbTkSKo5ICGCKgBCiVAXOwlhLL5p4y2KoSiHr8Qqm7zN0k6SnAJcom125HtpaQlyuAsUV8IPVUpZ9geOHGUvQQlKgmhKEGaW18IEexCCH+tJISkg/q3zoFTYURl0ypBecAW0FQIWQQMK7os+hjyReYHEVstlncvgxkSF7rUuz4hZDHaLawumlFUHZhCOGPR2NPI16pF724IHVRCCIt/eeQoXILW3Z39gFjTUqIMEPHlJYxVdBq2PrriWULwPlur0oRa2sx7zj+gBKcWoJ0l2oRYWQgtQXkFwG6A8dMQmouEkI2dl/wzt0yOeLSOOyjiWQjjfYQzAg5CuDNoKoSgdzf3fFyiGR1QSCSEahfE2oWQDbQhCEil6bUyG6yt/C3zT2SB3iEhHOcdBIUEl6DNH85+gLJYSpQBTbqpElSk1H8MHkIoS7EqTYyfkN5Z5MhZ4oAQKwshleBqkHtVbqG5SAjZ2PFvn2H/+ZAODk96B4J48hIPBoFHXxDCXUFTIZREFrliZhRuonh2fUJYJ6T02GBt1cGS523VYZrZQdy7gaPbZj+cJarB6Y+JawLD8pSKu0ucROSKsp0lkpKqSrzrFsI6IbbhqIGjE6xJzB8wlsvkyLYTp5tUJpx6F4RwZ1AUQrGZtZIQ6i/C4ivGuO+9Hzzi25wQruuLkLVV7BOuIYT8v3veQRnx+YWQu/YxtnwR8gXox5NqHzr2Zdj6X4SZGWuaVSFZc+7NtjixWNUahZB9XE4VzO87n7tse7MHormsrZWEUH8RsnEmXNI7QFXpnheFcGGUwI4LQrgrKAqhOFlSSQj1HGFRCBn39f6b1tRoh+cIWVtZJ2oKIVcW3sGnykLIXbtcWOYI+R4PuROn1hyhslF/jjAzY02zKiSEZJNTmRBaqlqjEKKdSeaMn89dxYNSYEDMCFcSQj1HyMaZcEnWRlXpnheFMDZKYMcFIdwVFIUQxbMeIfREY+a66kaEcF2rxkZzqwuheFv9gS6aKiA23Jud3cYdy7A1V42da8BICFerao1CiFDjkIplfNDFcr8QGq1KbX9FPe9Wf65BCHcGRAhbSX4xRlUhvBy9WjaiwXvBOHOnnXEubieF8HKcN7eGEPLddLyDcldgIyGE7Wm//Titdnl7O/l8vXwVbicb8xoJod4SSJ9SbSG0VNVICO37CBGqViWGM7lMSasX3GdUSQjFPsIf3yynF3HP+2dRJSEM+wh3CUQIYbGrshCKBU9yNEHNu5lnLzayfWaNQsgix7k5f1dWSM8R8g7K4LGREMKMH59MNefvnMDrzE+rC6FeAKZPqbYQWqpqJIT2kyUIVasSw1nt7TI7wQGTy5WEUEzN9u4tc6a45xlemXYinCzZJRAh7Bzml+dWFcLR1bXlsKp4kxhHTuPushDy87OsuXVWjaGEOjncSAjhCOvn779Vu7z9w+H5xfhSuJ0c3m0khPrYMH1KtYXQUlUjIbSfNUaoWpUYzuTCdS2EcOd5JSEUZ42/f7XdcIZ6Hpc+DI1w1niXQG6fYXGXjhp4uFdl+wzNykUFTEFdsyquyvTccNP09pk6KdtQGB9VfMXspxycQqjuvP3128uABcHqklDIn8d6Z7ltpay59v9KmgmhmM43rqVxEqiqSiWaCaH19hnIYmc5MCfoYpo8HhcvX8UEBm6VjGchYPYLoT6tB4fy+HWxia4K97xItA1CNzfcPrNLIPcRwk4LETXwcK+KEB7Azg+yMcMihPgkxch3kqLpfYR6XdUfa6IwPtqMEKojJ3wVHTbcwOaPRb4lhPXOssejrLnrF0Jzl0y17TOVSjQVQos/YPuM5QoFQT/KZ24OA7nnJSatkvEsBMyVts8I43BNg9oejVxb3Ffj3D4T7iPcNZAbqi/GMi6Gu6ArCSHNyuUUQpWKSaTT8dyC3fSG6jop21AYH21GCFVerPOvvyYsCFaJhCB/Huud5Ubm0uauXQjNq6udBKqqUommQmjxB2Sxs1yqJehimjweF48vxQQGbpWMZyFg9guhvtELLu7iKaUOjapQz4vEB4PQzQ03VO8SzJwlsOol7mABvTs6gej0mn3a88BOxSuS4FEuWphrL0Q+ER7SFhPFw+IbslGGRjlL9BxQJQM1c5bkC7d5B/m6ZhtV9UVVRa62pWdRjJh5Zi/h8Qcv8e2HzuoBy8myVTFpro0QVb0U5ikoMSPpT55l+pOZt8SZSbDmvhpRpQ8kZ8lZwcYX01f0EJMaBrrExFipr5mzxJb+pC/Tnzx7CbI4HHKW7CDMLHaQ04sn2FIakvQgyduVTPImkm/FkliKEirvHRB8knG6tGQ7g8zayEYZGmWxqyOE9bPYQbq/CWRUMzuo8gAiR8km2YRQ9c5SwuMPs7k8ORsQslUZLeEkdJI3ZZwSI5IQ714mxBt5S8QmkeeLm1TOF0ey2MUFG1emr5xCqEvoqYraWexsCfFSmRDv3kuQbocsdjsIM68xQNzTDBrSOoDo9IJHBiywU/GKJHiUixbmPtyJnMM8FLQkis8X35CNMjTKa1xHCOvnNc4XbvMO8nXND6iqTFVF0l/ZhRBPFVRJmIVKfP2uM//CcrJs1Zw010aIqmaFeQpKnJMUybcyRfK5v4RJsOZeG1GlDySvcVSwkZm+cgqhLmGu1NfNa2xJkRxjf5QRZHE45DXeQSghFP+O5YX16jHBRJaYIoGZGBiaishn46QiMCFUf7QJobLBBNU/hRdZZ/xQkyI8LYVeykoGUD/yeqr/nHSwg7g5JagHUe+qNhf5Q/X8g8uykygzjgjiD3M2rkIJ1NziZFkpyAQlsYEqsc8RjgicnD+xn9O4tlyTqPS0A7YEIoTwRZ//52nEPRBB8EA36+vM2orgUDEiC43VH+2JwIUNFeh6AMF0bkP+HDWJIeuhVukoppIB1I+8nuo/Jx2MEZdRgnoQ9a5qc5E/VM8Tl2UnUWYcEcQfcda3EM4SqLkJNLdqKnXzuRZtoErMVtl+7uH8Oe+dxrXlmkSlpx2wJRAhFMeb1D7CKJ9thzllvvQBu7Vg+loR+Y49+ZHfXui/WhZLtI2Xhwrb/CLrrkDUpAhvXUMT95UMoH7k9VT/OelgC3ExJagHUe+qNhf5Q/W87bLsJMqMI4L4w9yxV6EEam5xQ10pyCZGYgNVYt9HmBE4OX9iP6dxbbkmUelpB2wJRAjLoo8VodLbich1Q5HBB3ObRUBAQEAFFEPjOvFCHaiYWUSuG4oMEhWEBgQEBFQDEcKy6GNFqPR2InLdUGTQNo9iBQQEBFQAXTXeHCosJwcEBAS8BbYnhIulvmtdHBkNCAgI2AVsTwj9y8kBAQEBb4LtCWFAQEDAjiIIYUBAwN4jCGFAQMDeIwhhQEDA3iMIYUBAwN7j/wF6mS32mtK/nwAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMy0wOS0yM1QwODoxMDozMCswMDowMANReRQAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjMtMDktMjNUMDg6MTA6MzArMDA6MDByDMGoAAAAKHRFWHRkYXRlOnRpbWVzdGFtcAAyMDIzLTA5LTIzVDA4OjEwOjMwKzAwOjAwJRngdwAAAABJRU5ErkJggg==" alt=""/></p><p>如上代码所示，我用score来模拟第一阶段的星星数，如果score达到了112再来模拟score2的分数，这里我限定最强王者阶段的星星个数上限为100。同时我们还模拟了用户注册的时间，这是因为排行榜可以有两种表示方式，第二种方式需要用到这个时间。</p><p>第一种表示方式为并列排行榜，也就是分数相同的情况下，允许排名并列，如下所示：</p><p><img src="/blog-base/static/httpsstatic001geekbangorgresourceimage6e2e6edf318c5f4cbe7b48f6da3b65d2982e.44dcb346.png" alt=""/><br/>第二种为严格排行榜。当分数相同的时候，会按照第二条件来进行排序，比如按照注册时间的长短，注册时间越长的排名越靠前。这样的话，上面那个排行榜就会变成如下所示的严格排行榜。</p><p><img src="/blog-base/static/httpsstatic001geekbangorgresourceimage6e7e6ec6befb0ffbc2a7a8682d309f96217e.5aa562c7.png" alt=""/><br/>你能看到当10013和10015得分相同的时候，如果按照注册时间来进行排名的话，会将10013排到10015前面。</p><p>上面的数据仅仅为示意，下面我们用实际的10万条数据做一个严格排行榜（你可以点击<a target="_blank" rel="noopener noreferrer" href="https://github.com/cystanford/mysql_user_scores">下载地址<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>下载这10万条数据， 也可以自己使用上面的存储过程来进行模拟）首先使用SQL语句进行查询：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">SELECT (@rownum := @rownum + 1) AS user_rank, user_id, score, create_time</span></div><div class="token-line"><span class="token plain">    FROM user_score, (SELECT @rownum := 0) b</span></div><div class="token-line"><span class="token plain">    ORDER BY score DESC, create_time ASC</span></div></pre></div><p>运行结果如下（10万条数据，用时0.17s）：</p><p><img src="/blog-base/static/httpsstatic001geekbangorgresourceimage14f814d88fd5293ac312e585ec05529473f8.7cdca0ed.png" alt=""/><br/>这里有几点需要说明。</p><p>MySQL不像Oracle一样自带rownum统计行编号的功能，所以这里我们需要自己来实现rownum功能，也就是设置MySQL的变量<code>@rownum</code>，初始化为<code>@rownum :=0</code>，然后每次SELECT一条数据的时候都自动加1。</p><p>通过开发程序（比如Python、PHP和Java等）统计排名会更方便，这里同样需要初始化一个变量，比如<code>rownum=0</code>，然后每次fetch一条数据的时候都将该变量加1，作为记录的排名。同时，开发程序也可以很方便地实现并列排名，因为程序可以进行上下文的统计，当两名玩家得分相同时，排名相同，否则排名会顺序加1。</p><p>如果想要通过SQL来实现，可以写成下面这样：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">SELECT user_id, score,</span></div><div class="token-line"><span class="token plain">        IFNULL((SELECT COUNT(*) FROM user_score WHERE score &gt; t.score), 0) + 1 AS user_rank  </span></div><div class="token-line"><span class="token plain">    FROM user_score t</span></div><div class="token-line"><span class="token plain">    ORDER BY user_rank ASC</span></div></pre></div><p>这样做的原理是查找比当前分数大的数据行数，然后加1，但是这样执行效率会很低，相当于需要对每个玩家都统计一遍排名。</p><h2 id="lua是什么如何在redis中使用"><a aria-hidden="true" tabindex="-1" href="/blog-base/sql必知必会/04.第三章认识dbms/06#lua是什么如何在redis中使用"><span class="icon icon-link"></span></a>Lua是什么，如何在Redis中使用</h2><p>知道如何用MySQL模拟数据后，我们再来看下如何在Redis中完成这一步。事实上，Redis本身不提供存储过程的功能，不过在2.6版本之后集成了Lua语言，可以很方便地实现类似存储过程的函数调用方式。</p><p>Lua是一个小巧的脚本语言，采用标准C语言编写，一个完整的Lua解析器大小只有200K。我们之前讲到过采用标准C语言编写的好处就在于执行效率高，依懒性低，同时兼容性好，稳定性高。这些特性同样Lua也有，它可以嵌入到各种应用程序中，提供灵活的扩展和定制功能。</p><h3 id="如何在redis中使用lua"><a aria-hidden="true" tabindex="-1" href="/blog-base/sql必知必会/04.第三章认识dbms/06#如何在redis中使用lua"><span class="icon icon-link"></span></a>如何在Redis中使用Lua</h3><p>在Redis中使用Lua脚本的命令格式如下：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">EVAL script numkeys key [key ...] arg [arg ...]</span></div></pre></div><p>我来说明下这些命令中各个参数代表的含义。</p><ol><li>script，代表的是Lua的脚本内容。</li><li>numkeys，代表后续参数key的个数。</li><li>key就是我们要操作的键，可以是多个键。我们在Lua脚本中可以直接使用这些key，直接通过<code>KEYS[1]</code>、<code>KEYS[2]</code>来获取，默认下标是从1开始。</li><li>arg，表示传入到Lua脚本中的参数，就像调用函数传入的参数一样。在Lua脚本中我们可以通过<code>ARGV[1]</code>、<code>ARGV[2]</code>来进行获取，同样默认下标从1开始。</li></ol><p>下面我们通过2个例子来体会下，比如我们使用eval <code>&quot;return <!-- -->{<!-- -->ARGV[1], ARGV[2]<!-- -->}<!-- -->&quot; 0 cy 123</code>，代表的是传入的key的个数为0，后面有两个arg，分别为cy和123。在Lua脚本中，我们直接返回这两个参数<code>ARGV[1]</code>, <code>ARGV[2]</code>，执行结果如下：</p><p><img src="data:image/png;base64,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" alt=""/><br/>比如我们要用这一条语句：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">eval &quot;math.randomseed(ARGV[1]); local temp = math.random(1,112); redis.call(&#x27;SET&#x27;, KEYS[1], temp); return &#x27;ok&#x27;;&quot; 1 score 30</span></div></pre></div><p>这条语句代表的意思是，我们传入KEY的个数为1，参数是score，arg参数为30。在Lua脚本中使用<code>ARGV[1]</code>，也就是30作为随机数的种子，然后创建本地变量temp等于1到112之间的随机数，再使用SET方法对KEY，也就是用刚才创建的随机数对score这个字段进行赋值，结果如下：</p><p><img src="/blog-base/static/httpsstatic001geekbangorgresourceimageb5beb569fe5c81ae82bd8e38cc2a93df72be.6be4a82d.png" alt=""/><br/>然后我们在Redis中使用<code>GET score</code>对刚才设置的随机数进行读取，结果为34。</p><p>另外我们还可以在命令中调用Lua脚本，使用的命令格式：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">redis-cli --eval lua_file key1 key2 , arg1 arg2 arg3</span></div></pre></div><p>使用redis-cli的命令格式不需要输入key的个数，在key和arg参数之间采用了逗号进行分割，注意逗号前后都需要有空格。同时在eval后面可以带一个lua文件（以.lua结尾）。</p><h2 id="使用lua创建10万名玩家数据"><a aria-hidden="true" tabindex="-1" href="/blog-base/sql必知必会/04.第三章认识dbms/06#使用lua创建10万名玩家数据"><span class="icon icon-link"></span></a>使用Lua创建10万名玩家数据</h2><p>如果我们想要通过Lua脚本创建10万名玩家的数据，文件名为<code>insert_user_scores.lua</code>，代码如下：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">--设置时间种子</span></div><div class="token-line"><span class="token plain">    math.randomseed(ARGV[1]) </span></div><div class="token-line"><span class="token plain">    -- 设置初始的生成时间</span></div><div class="token-line"><span class="token plain">    local create_time = 1567769563 - 3600*24*365*2.0 </span></div><div class="token-line"><span class="token plain">    local num = ARGV[2]</span></div><div class="token-line"><span class="token plain">    local user_id = ARGV[3]</span></div><div class="token-line"><span class="token plain">    for i=1, num do</span></div><div class="token-line"><span class="token plain">      --生成1到60之间的随机数</span></div><div class="token-line"><span class="token plain">      local interval = math.random(1, 60) </span></div><div class="token-line"><span class="token plain">      --产生1到112之间的随机数</span></div><div class="token-line"><span class="token plain">      local temp = math.random(1, 112) </span></div><div class="token-line"><span class="token plain">      if (temp == 112) then</span></div><div class="token-line"><span class="token plain">            --产生0到100之间的随机数</span></div><div class="token-line"><span class="token plain">            temp = temp + math.random(0, 100) </span></div><div class="token-line"><span class="token plain">      end</span></div><div class="token-line"><span class="token plain">      create_time = create_time + interval</span></div><div class="token-line"><span class="token plain">      temp = temp + create_time / 10000000000</span></div><div class="token-line"><span class="token plain">      redis.call(&#x27;ZADD&#x27;, KEYS[1], temp, user_id+i-1)</span></div><div class="token-line"><span class="token plain">    end</span></div><div class="token-line"><span class="token plain">    return &#x27;Generation Completed&#x27;</span></div></pre></div><p>上面这段代码可以实现严格排行榜的排名，具体方式是将score进行了改造，score 为浮点数。整数部分为得分，小数部分为时间差。</p><p>在调用的时候，我们通过<code>ARGV[1]</code>获取时间种子的参数，传入的<code>KEYS[1]</code>为<code>user_score</code>，也就是创建有序集合<code>user_score</code>。然后通过num来设置生成玩家的数量，通过<code>user_id</code>获取初始的<code>user_id</code>。最后调用如下命令完成玩家数据的创建：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">redis-cli -h localhost -p 6379 --eval insert_user_scores.lua user_score , 30 100000 10000</span></div></pre></div><p><img src="/blog-base/static/httpsstatic001geekbangorgresourceimageba94ba8fcef75a2ea951dd31d9f7e266d094.70b5a725.png" alt=""/></p><h3 id="使用redis实现玩家排行榜"><a aria-hidden="true" tabindex="-1" href="/blog-base/sql必知必会/04.第三章认识dbms/06#使用redis实现玩家排行榜"><span class="icon icon-link"></span></a>使用Redis实现玩家排行榜</h3><p>我们通过Lua脚本模拟完成10万名玩家数据，并将其存储在了Redis的有序集合<code>user_score</code>中，下面我们就来使用Redis来统计玩家排行榜的数据。</p><p>首先我们需要思考的是，一个典型的游戏排行榜都包括哪些功能呢？</p><ol><li>统计全部玩家的排行榜</li><li>按名次查询排名前N名的玩家</li><li>查询某个玩家的分数</li><li>查询某个玩家的排名</li><li>对玩家的分数和排名进行更新</li><li>查询指定玩家前后M名的玩家</li><li>增加或移除某个玩家，并对排名进行更新</li></ol><p>在Redis中实现上面的功能非常简单，只需要使用Redis我们提供的方法即可，针对上面的排行榜功能需求，我们分别来看下Redis是如何实现的。</p><h3 id="统计全部玩家的排行榜"><a aria-hidden="true" tabindex="-1" href="/blog-base/sql必知必会/04.第三章认识dbms/06#统计全部玩家的排行榜"><span class="icon icon-link"></span></a>统计全部玩家的排行榜</h3><p>在Redis里，统计全部玩家的排行榜的命令格式为<code>ZREVRANGE 排行榜名称 起始位置 结束位置 [WITHSCORES]</code>。</p><p>我们使用这行命令即可：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">ZREVRANGE user_score 0 -1 WITHSCORES</span></div></pre></div><p>我们对玩家排行榜<code>user_score</code>进行统计，其中-1代表的是全部的玩家数据，<code>WITHSCORES</code>代表的是输出排名的同时也输出分数。</p><h3 id="按名次查询排名前n名的玩家"><a aria-hidden="true" tabindex="-1" href="/blog-base/sql必知必会/04.第三章认识dbms/06#按名次查询排名前n名的玩家"><span class="icon icon-link"></span></a>按名次查询排名前N名的玩家</h3><p>同样我们可以使用<code>ZREVRANGE</code>完成前N名玩家的排名，比如我们想要统计前10名玩家，可以使用：<code>ZREVRANGE user_score 0 9</code>。</p><p><img src="/blog-base/static/httpsstatic001geekbangorgresourceimage2e3c2e87be9528653b388f8a3dabedfcf23c.8a21145d.png" alt=""/></p><h3 id="查询某个玩家的分数"><a aria-hidden="true" tabindex="-1" href="/blog-base/sql必知必会/04.第三章认识dbms/06#查询某个玩家的分数"><span class="icon icon-link"></span></a>查询某个玩家的分数</h3><p>命令格式为<code>ZSCORE 排行榜名称 玩家标识</code>。</p><p>时间复杂度为<code>O(1)</code>。</p><p>如果我们想要查询玩家10001的分数可以使用：<code>ZSCORE user_score 10001</code>。</p><p><img src="data:image/png;base64,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" alt=""/></p><h3 id="查询某个玩家的排名"><a aria-hidden="true" tabindex="-1" href="/blog-base/sql必知必会/04.第三章认识dbms/06#查询某个玩家的排名"><span class="icon icon-link"></span></a>查询某个玩家的排名</h3><p>命令格式为<code>ZREVRANK 排行榜名称 玩家标识</code>。</p><p>时间复杂度为<code>O(log(N))</code>。</p><p>如果我们想要查询玩家10001的排名可以使用：<code>ZREVRANK user_score 10001</code>。</p><p><img src="data:image/png;base64,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" alt=""/></p><h3 id="对玩家的分数进行更新同时排名进行更新"><a aria-hidden="true" tabindex="-1" href="/blog-base/sql必知必会/04.第三章认识dbms/06#对玩家的分数进行更新同时排名进行更新"><span class="icon icon-link"></span></a>对玩家的分数进行更新，同时排名进行更新</h3><p>如果我们想要对玩家的分数进行增减，命令格式为<code>ZINCRBY 排行榜名称 分数变化 玩家标识</code>。</p><p>时间复杂度为<code>O(log(N))</code>。</p><p>比如我们想对玩家10001的分数减1，可以使用：<code>ZINCRBY user_score \-1 10001</code>。</p><p><img src="data:image/png;base64,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" alt=""/><br/>然后我们再来查看下玩家10001的排名，使用：<code>ZREVRANK user_score 10001</code>。</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABAoAAABtCAMAAAAfxHPvAAAAIGNIUk0AAHomAACAhAAA+gAAAIDoAAB1MAAA6mAAADqYAAAXcJy6UTwAAADeUExURVpse1BfbBYbHgAAAAYGBgwMDAEBAQkJCQMDAwsLCzAwMFpaWkhISGBgYBgYGFRUVAoKCp6enhUVFX5+fqioqCoqKpOTk2ZmZrS0tCMjI76+vrq6urW1tZCQkMDAwLe3t6mpqRYWFr+/v4eHh7a2tr29vS0tLTk5OXh4eCQkJEJCQpycnBISEmxsbJaWlq6urqqqqqurqxcXF1Zlcjo/QmV0gZSZnGd3hKarrmJxfoKHip+fn4SEhDY2Njw8PCEhIYqKilBgbR8kJ1treF5jZmZ1gp2ipVJibygtMP///0vhQbIAAAABYktHREmHBeR8AAAAB3RJTUUH5wkXCAoiJtd0GwAAAAFvck5UAc+id5oAABnVSURBVHja7V17QyK7kj+7DYoojSJiK4KODuADRGffex/n3n3cu9//E22S6qST6sqjAZUzp37/DWVVJenOb6qSdOqXX375h3/MGAzG7xy/MBUwGAymAgaDocBUwGAwMqYCBoOhwFTAYDAypgIGg6HAVMBgMDKmAgaDocBUwGAwMqYCBoOhwFTAYDAypgIGg6HAVMBgMDKmAgaDocBUwGAwMqYCBoOh4FBBq91uHTjig8N2hcMD6tdK3Al6wkqHB1kEzTVKvXo/0tzYSo5zI+jQPT/waxjBUSuxPV4fhAA8RzSOOnpUTMMIjUiLbVPqXTnCrSplRsDYAGLkj9A86hx5HlRNkMUEXh8SNhW0usfH3bYjbp8c9zSOT9rm1x6BkzzYSduUY22HGqVevR9Jbhwlp+dGkNM9b+NRQabkT/1uIheQPmTn64JySCIa/bwFo1I1jDBV77zTYtuUelf6uFUgqwSMDSBG3oxxibzveVA1QSsm0D562IeETQWn/bOz/sARD87Phhpn5wPz65DA+UWwk7Ypx9oONUq9ej+S3DhKTs+N4ILu+QCPCjIlfxr1T9PaQ/qQna8LyiGJaIwuTmFUqoYRpuqdd1psm1Lvygi3CmSVgLEBxMibMS5xMfI8qJrgNCbQPobYh4ShAhE/5pdF0bP+axeBxNWouB7fFEVxM74uRldl3JdPpgIgkLLba/nvSdffQ9sUaChrgZSigzTGUY3KE+pH7M+1m7vjb67zW+j5fXGpe96Fnt9WrVI9z0FjSmgIfHsovs/u7y7zdlJcYPv4Pr6fKhTCx1zaqUa+eiRCcDvDj0RqgKmh+n8k7xXSDgwM0pCmTIuh80KmWnzgtGqo/0tq94ZVq8AUyCoBoylg5Id2fCZi/cXddHYLj1W+D/JBiadCCfKgwPIxHRJRs6GCVj5fPN46U6j11H1+uR0PR5PJZDQc3748z5/UywxUAAIpexnHqMA2BRrCWvcpEEW2kcYwqqE9zZ9RP2J/rt08nCxd5y/Q89nto+45TAgQQKtKKlAaU0JDYLmavBaz9eNinkeZDPl4Hc4qKniSdqqRrx6JELwU+JEEqQBpSFOmxdB5IVMtbjmtIqjAmGIq2BYw8vY07bQvuv31tHiBxyrfB/mg8hYpWIQEto8wFYj48a24dqaQCCTex9fvq6s8z69W79fj9zLuAyoAgZQ9v8eowDYFGsJaMKW4QBqrqIb2dPaO+hH7c+3mR1vP1NL5M/T85rrQPYcJAQJoVUkFSmNKaMjnucznrzez4u0sKUewfcxXNxUVtKSdauSrRyIEz6/4kQSpAGlIU6bF0HkhUy0eOK0iqMCYYirYFjDy9jQ9FbH+ejZ9fYbHKt8H+aD6A1LwFhLYPsJU4LwpAJjxw17tCdsCKesOY1TQXKOLNHpRDe2p1o/4nxs3rvPy3S6qnpMTYoomnaPhtiplMa0+f+mRdx5JtzbAQSpAGoSp0i3+8zoV1IaLqWBToDHO6hPFPMTmAq8PDUEF//TPXQERVX8SFXTyi4UIYRpQgdR4jGqI0Ef246XWD4BIBboKKFiSecD5yaHztyLoFTh/Osx2RAXL1QOO1EI9H79I5yJnE09lNnyVyctqGXwkiAoOn86lRnMqEEPSf6myE4hGqz9f9xcXKnaiqUBlmWvR4rK5jDTIqF5AjHyICiD3JWZ8ksDrQ0NQwb/8q1xmFFH1J1HBaX/0tp41oQKpUUQ1YCkbYluCCoiNApMHDNruNrgIegUGaq1lJ1TQWf7AkVqo5+/P0rnI2cRTuVnNZfKy7AQfCaKCg9ZAajSnAjEk63GVnUA0Wv35bP0Gi880FagscyZaXDaXkYZTWPNfj4NUALkvMeOTBF4fGoIK/u3fqYAw+zAqKOdPAypookH0QzehwDJ/sGRhJ1SQkRmYtx/DrkcjlQqIDqZRgVfDjC6RBxil5D4yHJQzyB5gRwCvvf0Gbyyo+9AQVPAf/zkxa9XOU1xCmHwCYbL16G1B1owKIIRsQgXJGhDVvxaz6cdRgZ05ZM2oYHnygLcWvP04f1It3pAKRD7lbHjslgpkjiCizS2oACJVSDTE08U5m4Gz4UILwBRYw6b8/i1TFz4fcUEn5NxrioTI5+R7Ze/ElGbM1IKtLmLGpwq8PjRCawWtp6ojzqO3BVkzKlATYtyECpI1ImsFO6EC8HGhtxqaUAHs1ibk0cLHBRwJ3JAKDk/OSx8fQQWwtLINFcA7CXwqnq6zjQtcC3iwV3BoAZgCa9iU379l6tznIy44DDn3miKRsFYgV5uKmXmDmwtS1gq8OwjuhPAvDDehArMknkwFyRrak6cfO6ECclTSqCBiiurKhlQgBEQ+sysqAKVtqABel1Cr9IOyHgwtMEFvk+wEdWVTQTvk3Gsq3jCaCszri2d8qsDrQyOJCg7aP5xzBa5skHBKwKaC6+K9ybJhqRFfNtSePP0glg3RKYHqXAGgs/xBnBKoj8oQjt/a5wroGX8Kq2qvKatqsNA4QwuN9okO55F0XUEyFeBzBUlUIJTgRIXjRnTeWWj0P1ofFbQG8ojCbP0Gy9g3q6vykWjBEAvkJrpeBwNTkTXLA2TqXZuKCcY1wSntvN3xasQQoQIxMMTqYKrA60MjiQoOVYxenTZ0ZecJZwdtKhDpcpPNxFIjvpmoPXn6QWwmorODOLYUERZxdrA+Kl0hQ6cNaSrowF5bkbLXBtuPa7T9aJ/zdB5J1xUkUwE+bZhEBUIJcjbHjei8s/3of7Q+KhARt0hl1/0FJKyz4ah8JFrQxQJ5tO7FmY2RDOwQmRprUzHBS03QoZ2fLL0aMUSoQAwMsWeYKvD60EiigqPjO+cbBFd2lvBFgU0FxeVVvrhrQgVS4zKqoT15+kF8i4y+KKi+QQB8e7gjviigRwV9g+DJA+R3Hnf3s+93D9+yCITz7+N75zMAM47EZyFdJEilAvwNQhIVCCX4+sJxIzpfHZEPwUsF8zP5OcPdIhcP6eqyuB/flI9EC9pYIA/cj5zZeD8Oju4RMnWtTcUEo5rA4/z4m18jgggViIER1ogZnyTw+tCIU0FHxsGxGDn2JZoJbEUISRyJ8g5LpfERpw3NXrkI5Ij9cEgp3tTWPg46iVGBDxAhINtyuMxRZfw5I4yjEJRx38R9wkIAXUmmgspUz431zalnRyAjTvgEC1LQCZLBWEWiYS8VQMQtz3moQxVVMgca7885bpXd4oveH97QqNRxqn3kyEdbt0o9yrpgQu7v2s5xjP5KNjf+PhJUIEyJ98Fekmgu8PrQiFNBaBMslDkQr7CIlEQI2YQKKo2PowIISIlTcpBS0Mv+xKjAvgoEZFsOl/mACe9DwTgKQRn3ISoQAuhKMhVUpnpurI/3l81YmQ0qTAUQjUKMHB52HxVAxC23KNRRyyqZA43xC7XrbVr8x96fFmhU6uhoHxPkw6ECQhCiAnCOY/SCbG78fSSoQJgS7wMx4xsIvD404lTwTcbBKTFyCCawlSFkAyqoND6OCiAglZE7ii0hpchlQFoLOolRgT8vA7Lthst81oyvPoJxFILSDaICmU+oriRTQWWq58b65gtpRyAjzpG1MD1BMhirSDTspQKIuIXzs/mRc+kSaFzfFrhVdov/0PuRX0a3aLSPAvlwqIAQhKgAnOMYfUY2N/4+ElQgTIn3gZjxDQReHxoRKggdmA1lDhi5zjRhSTyZCiqNrakA9gOcjYKkz2gaHiPeKNGihwsfI7YFA7QZgc5pO/sKkc1E57SwnTMRmYM8XKwPs2Iq2MlmIpwef/3zr+pBHTgasLpPbwPJE9H901MI7CMDbPswR84dKnCef5wKwLnJKkqNMdnc4MD4qGCqj3zjGd9A4PWhEaGC9snxajIeTy6JG8La3eNLKVsl3F5lqKBQpppQQamxNRUQ95ZtSgWhUfHOhubDZaiglff11WVaoKwV46G2ZlNBq9t3fw1TQWkKGga/Fo+XYqBEHwkqgM5/FBXkJ9RFXGXQ+0hd62Va3O+2WnBpW2SAbR/m0rZtqACcmxvjtCmyucGBCVCB9JG3iBmfKvD60IhQAaxjF2gdu5QFMgf63Z7qm3GaUEGpsTUVwH6As1GwKRWERmWjRIseLkMFR/OzMkExggO0GeF8g9A6cvYVIlRQmoIkyM6ZiMxBmIJroj6KCuDS1F//cqce1JGjAav79DaQaLFMplop9+HaPs60j22oAJybrKLUGJHNDQ5MgAqkj05GzPhUgdeHRogKzGVf8pnUL7L1PvdyTOw/N2sFMPSYCgiNLtLo+TTQIG962tChAvt63ya3D8A0ua9vHnkF9JsK+5Lla9o6yhd3xIdgwc+ROkfVTWfW7tz3Gg82O20IAsVqtc1EIQNBjO5CawUw7JhrfXl8+N2mR9f1YXZrt1krQM4dDdzcEEJrBWfzI9t/c0F0uEJU0D7preRpFREHt4iLbEOhML6jGF5hYQoCMkwFhEYXafR8GqhTO6EC56bgBlTgzRxCKUWtoXLYy6AzU+H+5WPRkArKlEKYehxW4b5MAnB2tAkVQEpBUIGTa/jfeB8VwE29YtjxcNnT1Lm5OWtKBS3to3wkhfbR9vnYkgpwc0PwUoHINeBlxDO+gSA6XCEqsK/nPDo+kyGbvY4eCoXLUNz8uVn5hiVxTAWERhdp9Hwa6L/ZnVCB+N9UBo9ziEfSqcCbOYRSCgy4zbSMeM0ZrmZUUKYUIsBYjKr9AOf4zxZUACkFQQVOruF/4wNHjGDYcRBlT1N48nSWF8eR9lEGaub4T9vnY0sqwM0NwUsFIteAEBXP+AaC6HAJKvjrf7mbYCZMN/MXNqhqE8JHBfgWrsxmFQUR8Yo0t3iY+zXmSOPSp4HSTNjrcvqhm1Ajj9JHfTPRFdQ2E2kqONA3BdOCMtFKfSHAuTPykDkQ8xdmvHlWMMAVq4muQK7lXOm8IE0lUQHtPPlCM/tQ4a89awVli9OGhjkj+JDThsj5BqcNIW0x1kxKoUxdV8sOJssjBTchAekDUcF//0/PLBeL2K6q8WGievGLExA2pwKTa0BULyLe8XBVFVEhNHKkMfFpoMXn1bDqhxOmEjsIpY/HsoNVYOsKasv+NBVAH70CSLSSqQCcOyMPmQMxfyEPMM8KBrjKdcpW2dmJ0dieCipTqVQgYnSTtjgDbAucBEELerRgOq3yqQhayJQZlZhg6BPUnXs1gq0SMNbMW6pMFdVmhMnySMFlTFDzYY8YutDsunivanyYU65wmHUbKjAnaWGb9W0tt8TzZcuv0UIahU8DbUnDuVjoh7PBTJwrKH3UDx67gtrBY5oKBufmNjVKoL5PS188AufOyMPXj8T8hVvIzLOCAdZ3S6iuTNUZbudK5/V4N1RQmUqlAvsDxNfer9Vpiy2+TISt/fjgfsiXich58y8TncvGoP9wEkGZeq+OKJiT3aTgKiQgfdgjJqjgf/9WYEA0/O0B/+6Eyd4siMj8MytA95raTMMO90PNpWH7cLriFRgZDvfNcNGCs6TsgOxH2RUjAFPV8o1Xw26u4z9iClZJnAdsC2jnICMWlUJ9FP6PwM3DN9z5O7LFjgAyf7srJXDZQLuSpG3qzOcjLjjyOg+ZIuGYqr3XZ6mCo5CA9GE3zFxo5gAO3C9X+HfnJL731hgQ1P589RAxtZkGeXEMoUHD9uF0xSswsgd0OY0ZLloQv8vG24+yK0YApg5PzrGA7jw0l76WhzZF3DCErnIjnIOsEiT1Ufg/BDerJe58k1uMUAery8YQygoyDS4r8goOfc6Dpkg4pmrv9Xmq4DAkIH3YDRNU8Pf/yzEgGu4s8e9OmNxp/yDu+zCC2p/rAN1rajMNO9wPNZeG7cPpildgZDjcN8NFCwZJ2QHZj7IrRgCmDtoDLKA7D811/EdMwV3PzgO2BbRzkFWCpD4K/wfgZtnBnf9BttgRtAbVr3YHT1HZQKeSpG1q4PMRFxz4nAdNkXBM1d7rQargICQgfdgNc4qqMxg/B4hoODln/L2CqYDxE4KIhpNzxt8rmAoYPyGIaDg5Z/y9gqmAwWBkTAUMBkOBqYDBYGRMBQwGQ4GpgMFgZEwFDAZDgamAwWBkTAUMBkOBqYDBYGRMBQwGQ4GpgMFgZEwFDAZDgamAwWBkTAUMBkOBqYDBYGRMBQwGQwFTQb00ovo1pSrlHuAAah2mVBtw9Vq1qnZgiqjL6AjsUfFqOLKk4nkMxqcDUQGURuyhindptar3AFD2JKk2hqvXPSaqHNIlsW2BMyptpx64x1pa8TwG49OBqABusS/QXZDOTfX7DOLG/zS94zu61kGkQAIqN1DQGhlZpY3B2Cs4VNAypQnd95WoIBqCCLebx+g7gaxSOqsKZSc2V9XRdKo8daDKoSo7WpX0QwIluy5GSmYqoWONzKqZyFTA2F/YVNCCktiyNCEKb5tRgQi3m8foO4EslD1MqFFXU5qMHSrw1ky0BVYlx3ZVCZ2osmgXjOQEgbGnsKngtH+mSxO618I2pIJB/yypft3u0Vn+gEKLUHEusbnnZ+/FtUMFF1Dl8Pkqz/OqpB8SKNn79fhdlpiEeoaERmbVTMzJCjIMxj7AUMFBiyofDmiyVgDh9rD3Vf/5yRwBAvR4juCUYbepwK4V6vCgU0S0VRY8nwqZXVLQ0TCZQ/MVDAbjE2GooJXPF4+3s+ErUTTCqWoXQetp/vx4+3VUsFw9vA5nt4/P8zyao7SfZBm955fbjaigI0dsXVKBXVLQ0RA+nl+m45dRcs1EBuMrYKhgILODWvlwgFPVLgIIt7+OCmSOAAF6PEewy7A3pwLIp0oqsEsKOhomc0iumchgfAWACiCqvx/f4AVu59gMfZgGCSDclov4IaVD8syOmEhQDPuwU9Mw4X5H/yp3KcgTUd+O7+TSvr2ITwOi+u+ze5oK7ha58EFTAeRTUwBaRPGnFAzG3gKoAKL62XCEy4cLgVOPWv9aK1RtBBBurx8XdRllyhaIkL4shv3UrmmYcL+tnV/knU5+ga1lqhj4aDiWOcJTOEeAqP5V/ddOUMG6vxA+6IkN+RRTAeOnAVABRPU3qyu8wC0ETj1q/WutULURQLg9K97qMsqULRAhfVkM+/yipmHC/QvtfNQ/Pe2PsLVMFQOXS/v2Ij4NiOrnrzc0FczWb8IHPbEhn2IqYPw0ACrIJ7CIXntfQQCoNhPzydSGV4BklClbIGZjuztUc6tb0zAztat9DHvtdm9I73J6BQR052tUoH1QEzvvVW1jKmD8BIhQwXIl9w5Gwxkx48fDkZKNb190KL5cleE2yKptB8gcCI22JfhL78+L/npWvE5WT47ACfeftA9DBcJamVIYbEkFxodIdJx9FZsKRD4lGuZQAaQ0hIbINXCiw2DsFSJUYN5tggpgPWDxKCevM+OJtQLgCELjyRL8qffH0cu4nNhPSMPMrbb2YaigJA8bW1KB8TGW031W8ZBNBbeSJtYOFRjmxBrjF02NJyk7sgzGpyNCBQB82hCoADYM8aQDU3gz0avRbSywfYCgSimsFm9FBVk4OwEqKIz/ehJE5DNYwGDsFT6VCuDs7dXqPZkKCA3jQ8h+7b3qrf2dUkFrKRcTZ+u3d7U0WJ22KFv1fDVf3RBUAAudzvkMswKJBQzGXuFTqcBk/slUQGgYH0ImVxfKGH2nVFBmJ/3Fs0qNcOYvwv3X4Yyggshagfc4J4Px5fhUKiC2FiJUENmMkHsOveHuqaC+UUC0iqACYri8BxcZjL1C5FwBYFdUYE4bVIcBIlRAaBgf8AEiHC0oTyIAks8V2NZoKjDHBzAVKOenTAWMnwaR04aAXVGB2VeothYiVEBoGB9CJs8n5tb5REDyaUPbGk0F5lAhpgLlvMNUwPhpEPkGAbArKqi+TDAfDkSogNAwPsrLilrWVwuA5G8QbGs0FZhPDTAVKOcZUwHjp0HSl4kbUcFBe1B9zmhrOIIL61oP79aCo5H56AbQ5MtE21qTLxPhRLLpfPDLRKYCxm8Dhgra8jYz9yIug42oAC5P1heBWRquwLrs63JS0FTgaGRhKoDryWQ/Us/6NqeC4vESbmyrqCBX1x3381bGVMD4TSLpFqONqAAuTy6t2RqOoGNdAXozvqapwNHIwlTQ5BYj21oTKoCvlzObCry3GDEVMH4biNxtKMJtuKxPHrQRAoFlK0gFsBkhIn64969cxB+4eUAlyKwPEOG0kH3lh6Vh9gPg+M9UHTHCGx4N7za0v0wUqVEtbdnF3YahSw8ZjP1B5MZjKOUhMgd1pGelyqXkQSoo7w+eXIKpMqpvu3lAJTA+cIKAMgd86bD6w0ui8kiTG48hqgdrwkEtbdnFjcehq5AZjP1BpA4ClPK4Gct7fqRAlkuZB6kANiNExF/VCMjcUgCOILMuK4JLQ+3rQS0Nsx8gQnG4d+i6vuHRsA6CfYuRSI1qacsu6iCECiQwGPuDSHUkVAqopAKoAwRX+OI8PlObebhyEDJVCTpWlUPMKnSBonm0CFHy3cK2qXqto51VRwqVTWIw9gSRmomoQGCZIEB1QFhEx6v7mdqMwPUEkSlrM8AyReQaRBHCPFqaMLkei22qXgFxZzUTQ8UUGYw9AaIC2MHHy4YOli3xq9pEV1f44j3/TB38hT91f7VMVQK4nszepa+owNEwC4Sw1od/tTWS7xa2TeGG0c7rQ2Jr5D4Nf4sZjD0BLqr+2YDMHw4VwkLFb6BKK4Px8+GrqSAPbC0wGIxPw1dTQXlJSAE3e8hDDXyzB4PxBfhqKsh8WwsMBuMzsQdUAHeDOhckMxiMT8YeUAG9tcBgMD4Te0AFDAbj68FUwGAwMqYCBoOhwFTAYDAypgIGg6Hw/6DWFjT6EOHfAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIzLTA5LTIzVDA4OjEwOjM0KzAwOjAw9x5dBwAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMy0wOS0yM1QwODoxMDozNCswMDowMIZD5bsAAAAodEVYdGRhdGU6dGltZXN0YW1wADIwMjMtMDktMjNUMDg6MTA6MzQrMDA6MDDRVsRkAAAAAElFTkSuQmCC" alt=""/><br/>你能看到排名由17153降到了18036名。</p><h3 id="查询指定玩家前后m名的玩家"><a aria-hidden="true" tabindex="-1" href="/blog-base/sql必知必会/04.第三章认识dbms/06#查询指定玩家前后m名的玩家"><span class="icon icon-link"></span></a>查询指定玩家前后M名的玩家</h3><p>比如我们想要查询玩家10001前后5名玩家都是谁，当前已知玩家10001的排名是18036，那么可以使用：<code>ZREVRANGE user_score 18031 18041</code>。</p><p><img src="/blog-base/static/httpsstatic001geekbangorgresourceimage549154eae0a13dea61d15752469c9d42e591.8ae7861b.png" alt=""/><br/>这样就可以得到玩家10001前后5名玩家的信息。</p><p><strong>增加或删除某个玩家，并对排名进行更新</strong></p><p>如果我们想要删除某个玩家，命令格式为<code>ZREM 排行榜名称 玩家标识</code>。</p><p>时间复杂度为<code>O(log(N))</code>。</p><p>比如我们想要删除玩家10001，可以使用：<code>ZREM user_score 10001</code>。</p><p><img src="data:image/png;base64,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" alt=""/><br/>这样我们再来查询下排名在18031到18041的玩家是谁，使用：<code>ZREVRANGE user_score 18031 18041</code>。</p><p><img src="/blog-base/static/httpsstatic001geekbangorgresourceimagec085c06a95d1ef82cd215698585a40d91b85.f2366f4b.png" alt=""/><br/>你能看到玩家10001的信息被删除，同时后面的玩家排名都向前移了一位。</p><p>如果我们想要增加某个玩家的数据，命令格式为<code>ZADD 排行榜名称 分数 玩家标识</code>。</p><p>时间复杂度为<code>O(log(N))</code>。</p><p>这里，我们把玩家10001的信息再增加回来，使用：<code>ZADD user_score 93.1504697596 10001</code>。</p><p><img src="data:image/png;base64,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" alt=""/><br/>然后我们再来看下排名在18031到18041的玩家是谁，使用：<code>ZREVRANGE user_score 18031 18041</code>。</p><p><img src="/blog-base/static/httpsstatic001geekbangorgresourceimage18ec18de0c19c2dfb777632c8d0edd6e3bec.27221eea.png" alt=""/><br/>你能看到插入了玩家10001的数据之后，排名又回来了。</p><h2 id="总结"><a aria-hidden="true" tabindex="-1" href="/blog-base/sql必知必会/04.第三章认识dbms/06#总结"><span class="icon icon-link"></span></a>总结</h2><p>今天我们使用MySQL和Redis搭建了排行榜，根据相同分数的处理方式，我们可以把排行榜分成并列排行榜和严格排行榜。虽然MySQL和Redis都可以搭建排行榜，但两者还是有区别的。MySQL擅长存储数据，而对于数据的运算来说则效率不高，比如统计排行榜的排名，通常还是需要使用后端语言（比如Python、PHP、Java等）再进行统计。而Redis本身提供了丰富的排行榜统计功能，不论是增加、删除玩家，还是对某个玩家的分数进行调整，Redis都可以对排行榜实时更新，对于游戏的实时排名来说，这还是很重要的。</p><p>在Redis中还集成了Lua脚本语言，通过Lua我们可以更加灵活地扩展Redis的功能，同时在Redis中使用Lua语言，还可以对Lua脚本进行复用，减少网络开销，编写代码也更具有模块化。此外Redis在调用Lua脚本的时候，会将它作为一个整体，也就是说中间如果有其他的Redis命令是不会被插入进去的，也保证了Lua脚本执行过程中不会被其他命令所干扰。</p><p><img src="/blog-base/static/httpsstatic001geekbangorgresourceimage0ef00e29dd3fbab97b475854f00941ae12f0.da1ee367.png" alt=""/></p><p>我们今天使用Redis对10万名玩家的数据进行了排行榜的统计，相比于用RDBMS实现排行榜来说，使用Redis进行统计都有哪些优势呢？</p><p>我们使用了Lua脚本模拟了10万名玩家的数据，其中玩家的分数score分成了两个部分，整数部分为实际的得分，小数部分为注册时间。例子中给出的严格排行榜是在分数相同的情况下，按照注册时间的长短进行的排名，注册时间长的排名靠前。如果我们将规则进行调整，同样是在分数相同的情况下，如果注册时间长的排名靠后，又该如何编写代码呢？</p><p>欢迎你在评论区写下你的思考，也欢迎把这篇文章分享给你的朋友或者同事，一起交流一下。</p></div><div class="__dumi-default-layout-footer-meta"><a target="_blank" rel="noopener noreferrer" href="https://github.com/GGwujun/blog/edit/master/ssrc/sql必知必会/04.第三章认识DBMS/06.md">在 GitHub 上编辑此页<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><span data-updated-text="最后更新时间：">2023/9/23 19:22:48</span></div></div></div></div>
	<script>
  window.g_useSSR = true;
  window.g_initialProps = {};
	</script>

    <script>
      (function () {
        if (!location.port) {
          (function (i, s, o, g, r, a, m) {
            i["GoogleAnalyticsObject"] = r;
            (i[r] =
              i[r] ||
              function () {
                (i[r].q = i[r].q || []).push(arguments);
              }),
              (i[r].l = 1 * new Date());
            (a = s.createElement(o)), (m = s.getElementsByTagName(o)[0]);
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m);
          })(
            window,
            document,
            "script",
            "//www.google-analytics.com/analytics.js",
            "ga"
          );
          ga("create", "UA-149864185-1", "auto");
          ga("send", "pageview");
        }
      })();
    </script>
    <script src="/blog-base/umi.js"></script>
  </body>
</html>
