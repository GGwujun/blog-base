<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"
    />
    <link rel="shortcut icon" type="image/x-icon" href="/logo.png" />
    <link rel="stylesheet" href="/blog-base/umi.css" />
    <script>
      window.routerBase = "/blog-base";
    </script>
    <script>
      //! umi version: 3.5.41
    </script>
    <script>
      !(function () {
        var e =
            navigator.cookieEnabled && void 0 !== window.localStorage
              ? localStorage.getItem("dumi:prefers-color")
              : "auto",
          o = window.matchMedia("(prefers-color-scheme: dark)").matches,
          t = ["light", "dark", "auto"];
        document.documentElement.setAttribute(
          "data-prefers-color",
          e === t[2] ? (o ? t[1] : t[0]) : t.indexOf(e) > -1 ? e : t[0]
        );
      })();
    </script>
    <title>28 | 怎么尽量“不写”代码？ - 大师兄</title>
  </head>
  <body>
    <div id="root"><div class="__dumi-default-layout" data-route="/代码精进之路/03.第二模块代码“经济”篇/12" data-show-sidemenu="true" data-show-slugs="true" data-site-mode="true" data-gapless="false"><div class="__dumi-default-navbar" data-mode="site"><button class="__dumi-default-navbar-toggle"></button><a class="__dumi-default-navbar-logo" style="background-image:url(&#x27;/logo.png&#x27;)" href="/blog-base/">大师兄</a><nav><div class="__dumi-default-search"><input type="search" class="__dumi-default-search-input" value=""/><ul></ul></div><span>计算机基础<ul><li><a href="/blog-base/编译原理之美">编译原理之美</a></li><li><a href="/blog-base/编译原理实战">编译原理实战</a></li><li><a href="/blog-base/深入浅出计算机组成原理">深入浅出计算机组成原理</a></li><li><a href="/blog-base/详解http">详解http</a></li><li><a href="/blog-base/计算机网络通关29讲">计算机网络通关29讲</a></li><li><a href="/blog-base/网络排查案例课">网络排查案例课</a></li><li><a href="/blog-base/linux操作系统">linux操作系统</a></li><li><a href="/blog-base/linux内核技术实战课">linux内核技术实战课</a></li><li><a href="/blog-base/linux性能优化实战">linux性能优化实战</a></li><li><a href="/blog-base/程序员数学基础">程序员数学基础</a></li><li><a href="/blog-base/趣谈网络协议">趣谈网络协议</a></li><li><a href="/blog-base/操作系统实战">操作系统实战</a></li><li><a href="/blog-base/软件工程之美">软件工程之美</a></li><li><a href="/blog-base/sql必知必会">sql必知必会</a></li><li><a href="/blog-base/操作系统实战45讲">操作系统实战45讲</a></li><li><a href="/blog-base/网络编程实战">网络编程实战</a></li><li><a href="/blog-base/趣谈linux操作系统">趣谈linux操作系统</a></li></ul></span><span>算法<ul><li><a href="/blog-base/常用算法25讲">常用算法25讲</a></li><li><a href="/blog-base/数据结构与算法之美">数据结构与算法之美</a></li><li><a href="/blog-base/业务开发算法50讲">业务开发算法50讲</a></li><li><a href="/blog-base/动态规划面试宝典">动态规划面试宝典</a></li></ul></span><span>前端开发<ul><li><a href="/blog-base/正则表达式入门">正则表达式入门</a></li></ul></span><span>前端工程化</span><span>前端性能优化</span><span>移动端开发</span><span>软件测试</span><span>产品与用户体验</span><span>面试</span><span>杂谈<ul><li><a href="/blog-base/代码之丑">代码之丑</a></li><li><a aria-current="page" class="active" href="/blog-base/代码精进之路">代码精进之路</a></li><li><a href="/blog-base/数据分析思维课">数据分析思维课</a></li><li><a href="/blog-base/朱涛kotlin编程第一课">朱涛kotlin编程第一课</a></li><li><a href="/blog-base/重学线性代数">重学线性代数</a></li></ul></span><div class="__dumi-default-navbar-tool"><div class="__dumi-default-dark"><div class="__dumi-default-dark-switch "></div></div></div></nav></div><div class="__dumi-default-menu" data-mode="site"><div class="__dumi-default-menu-inner"><div class="__dumi-default-menu-header"><a class="__dumi-default-menu-logo" style="background-image:url(&#x27;/logo.png&#x27;)" href="/blog-base/"></a><h1>大师兄</h1><p></p></div><div class="__dumi-default-menu-mobile-area"><ul class="__dumi-default-menu-nav-list"><li>计算机基础<ul><li><a href="/blog-base/编译原理之美">编译原理之美</a></li><li><a href="/blog-base/编译原理实战">编译原理实战</a></li><li><a href="/blog-base/深入浅出计算机组成原理">深入浅出计算机组成原理</a></li><li><a href="/blog-base/详解http">详解http</a></li><li><a href="/blog-base/计算机网络通关29讲">计算机网络通关29讲</a></li><li><a href="/blog-base/网络排查案例课">网络排查案例课</a></li><li><a href="/blog-base/linux操作系统">linux操作系统</a></li><li><a href="/blog-base/linux内核技术实战课">linux内核技术实战课</a></li><li><a href="/blog-base/linux性能优化实战">linux性能优化实战</a></li><li><a href="/blog-base/程序员数学基础">程序员数学基础</a></li><li><a href="/blog-base/趣谈网络协议">趣谈网络协议</a></li><li><a href="/blog-base/操作系统实战">操作系统实战</a></li><li><a href="/blog-base/软件工程之美">软件工程之美</a></li><li><a href="/blog-base/sql必知必会">sql必知必会</a></li><li><a href="/blog-base/操作系统实战45讲">操作系统实战45讲</a></li><li><a href="/blog-base/网络编程实战">网络编程实战</a></li><li><a href="/blog-base/趣谈linux操作系统">趣谈linux操作系统</a></li></ul></li><li>算法<ul><li><a href="/blog-base/常用算法25讲">常用算法25讲</a></li><li><a href="/blog-base/数据结构与算法之美">数据结构与算法之美</a></li><li><a href="/blog-base/业务开发算法50讲">业务开发算法50讲</a></li><li><a href="/blog-base/动态规划面试宝典">动态规划面试宝典</a></li></ul></li><li>前端开发<ul><li><a href="/blog-base/正则表达式入门">正则表达式入门</a></li></ul></li><li>前端工程化</li><li>前端性能优化</li><li>移动端开发</li><li>软件测试</li><li>产品与用户体验</li><li>面试</li><li>杂谈<ul><li><a href="/blog-base/代码之丑">代码之丑</a></li><li><a aria-current="page" class="active" href="/blog-base/代码精进之路">代码精进之路</a></li><li><a href="/blog-base/数据分析思维课">数据分析思维课</a></li><li><a href="/blog-base/朱涛kotlin编程第一课">朱涛kotlin编程第一课</a></li><li><a href="/blog-base/重学线性代数">重学线性代数</a></li></ul></li></ul><div class="__dumi-default-dark"><div class="__dumi-default-dark-switch "><button title="Dark theme" class="__dumi-default-dark-moon "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3854" width="22" height="22"><path d="M991.816611 674.909091a69.166545 69.166545 0 0 0-51.665455-23.272727 70.795636 70.795636 0 0 0-27.438545 5.585454A415.674182 415.674182 0 0 1 754.993338 698.181818c-209.594182 0-393.472-184.785455-393.472-395.636363 0-52.363636 38.539636-119.621818 69.515637-173.614546 4.887273-8.610909 9.634909-16.756364 14.103272-24.901818A69.818182 69.818182 0 0 0 384.631156 0a70.842182 70.842182 0 0 0-27.438545 5.585455C161.678429 90.298182 14.362065 307.898182 14.362065 512c0 282.298182 238.824727 512 532.38691 512a522.286545 522.286545 0 0 0 453.957818-268.334545A69.818182 69.818182 0 0 0 991.816611 674.909091zM546.679156 954.181818c-248.785455 0-462.941091-192-462.941091-442.181818 0-186.647273 140.637091-372.829091 300.939637-442.181818-36.817455 65.629091-92.578909 151.970909-92.578909 232.727273 0 250.181818 214.109091 465.454545 462.917818 465.454545a488.331636 488.331636 0 0 0 185.181091-46.545455 453.003636 453.003636 0 0 1-393.565091 232.727273z m103.656728-669.323636l-14.266182 83.781818a34.909091 34.909091 0 0 0 50.362182 36.770909l74.775272-39.563636 74.752 39.563636a36.142545 36.142545 0 0 0 16.174546 3.956364 34.909091 34.909091 0 0 0 34.210909-40.727273l-14.289455-83.781818 60.509091-59.345455a35.025455 35.025455 0 0 0-19.223272-59.578182l-83.61891-12.101818-37.376-76.101818a34.56 34.56 0 0 0-62.254545 0l-37.376 76.101818-83.618909 12.101818a34.909091 34.909091 0 0 0-19.246546 59.578182z m70.423272-64.698182a34.280727 34.280727 0 0 0 26.135273-19.083636l14.312727-29.090909 14.336 29.090909a34.257455 34.257455 0 0 0 26.135273 19.083636l32.046546 4.887273-23.272728 22.574545a35.234909 35.234909 0 0 0-10.007272 30.952727l5.46909 32.116364-28.625454-15.127273a34.490182 34.490182 0 0 0-32.302546 0l-28.695272 15.127273 5.469091-32.116364a35.141818 35.141818 0 0 0-9.984-30.952727l-23.272728-22.574545z" p-id="3855"></path></svg></button><button title="Light theme" class="__dumi-default-dark-sun "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4026" width="22" height="22"><path d="M915.2 476.16h-43.968c-24.704 0-44.736 16-44.736 35.84s20.032 35.904 44.736 35.904H915.2c24.768 0 44.8-16.064 44.8-35.904s-20.032-35.84-44.8-35.84zM512 265.6c-136.704 0-246.464 109.824-246.464 246.4 0 136.704 109.76 246.464 246.464 246.464S758.4 648.704 758.4 512c0-136.576-109.696-246.4-246.4-246.4z m0 425.6c-99.008 0-179.2-80.128-179.2-179.2 0-98.944 80.192-179.2 179.2-179.2S691.2 413.056 691.2 512c0 99.072-80.192 179.2-179.2 179.2zM197.44 512c0-19.84-19.136-35.84-43.904-35.84H108.8c-24.768 0-44.8 16-44.8 35.84s20.032 35.904 44.8 35.904h44.736c24.768 0 43.904-16.064 43.904-35.904zM512 198.464c19.776 0 35.84-20.032 35.84-44.8v-44.8C547.84 84.032 531.84 64 512 64s-35.904 20.032-35.904 44.8v44.8c0 24.768 16.128 44.864 35.904 44.864z m0 627.136c-19.776 0-35.904 20.032-35.904 44.8v44.736C476.096 940.032 492.16 960 512 960s35.84-20.032 35.84-44.8v-44.736c0-24.768-16.064-44.864-35.84-44.864z m329.92-592.832c17.472-17.536 20.288-43.072 6.4-57.024-14.016-14.016-39.488-11.2-57.024 6.336-4.736 4.864-26.496 26.496-31.36 31.36-17.472 17.472-20.288 43.008-6.336 57.024 13.952 14.016 39.488 11.2 57.024-6.336 4.8-4.864 26.496-26.56 31.296-31.36zM213.376 759.936c-4.864 4.8-26.56 26.624-31.36 31.36-17.472 17.472-20.288 42.944-6.4 56.96 14.016 13.952 39.552 11.2 57.024-6.336 4.8-4.736 26.56-26.496 31.36-31.36 17.472-17.472 20.288-43.008 6.336-56.96-14.016-13.952-39.552-11.072-56.96 6.336z m19.328-577.92c-17.536-17.536-43.008-20.352-57.024-6.336-14.08 14.016-11.136 39.488 6.336 57.024 4.864 4.864 26.496 26.56 31.36 31.424 17.536 17.408 43.008 20.288 56.96 6.336 14.016-14.016 11.264-39.488-6.336-57.024-4.736-4.864-26.496-26.56-31.296-31.424z m527.168 628.608c4.864 4.864 26.624 26.624 31.36 31.424 17.536 17.408 43.072 20.224 57.088 6.336 13.952-14.016 11.072-39.552-6.4-57.024-4.864-4.8-26.56-26.496-31.36-31.36-17.472-17.408-43.072-20.288-57.024-6.336-13.952 14.016-11.008 39.488 6.336 56.96z" p-id="4027"></path></svg></button><button title="Default to system" class="__dumi-default-dark-auto "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="11002" width="22" height="22"><path d="M127.658667 492.885333c0-51.882667 10.24-101.717333 30.378666-149.162666s47.786667-88.064 81.92-122.538667 75.093333-61.781333 122.538667-81.92 96.938667-30.378667 149.162667-30.378667 101.717333 10.24 149.162666 30.378667 88.405333 47.786667 122.88 81.92 61.781333 75.093333 81.92 122.538667 30.378667 96.938667 30.378667 149.162666-10.24 101.717333-30.378667 149.162667-47.786667 88.405333-81.92 122.88-75.093333 61.781333-122.88 81.92-97.28 30.378667-149.162666 30.378667-101.717333-10.24-149.162667-30.378667-88.064-47.786667-122.538667-81.92-61.781333-75.093333-81.92-122.88-30.378667-96.938667-30.378666-149.162667z m329.045333 0c0 130.048 13.994667 244.394667 41.984 343.381334h12.970667c46.762667 0 91.136-9.216 133.461333-27.306667s78.848-42.666667 109.568-73.386667 54.954667-67.242667 73.386667-109.568 27.306667-86.698667 27.306666-133.461333c0-46.421333-9.216-90.794667-27.306666-133.12s-42.666667-78.848-73.386667-109.568-67.242667-54.954667-109.568-73.386667-86.698667-27.306667-133.461333-27.306666h-11.605334c-28.672 123.562667-43.349333 237.909333-43.349333 343.722666z" p-id="11003"></path></svg></button></div></div></div><ul class="__dumi-default-menu-list"><li><a href="/blog-base/代码精进之路">代码精进之路</a></li><li><a href="/blog-base/代码精进之路/01.开篇词">01.开篇词</a><ul><li><a href="/blog-base/代码精进之路/01.开篇词/01"><span>开篇词 | 你写的每一行代码，都是你的名片</span></a></li></ul></li><li><a href="/blog-base/代码精进之路/02.第一模块代码“规范”篇">02.第一模块代码“规范”篇</a><ul><li><a href="/blog-base/代码精进之路/02.第一模块代码“规范”篇/01"><span>01 | 从条件运算符说起，反思什么是好代码</span></a></li><li><a href="/blog-base/代码精进之路/02.第一模块代码“规范”篇/02"><span>02 | 把错误关在笼子里的五道关卡</span></a></li><li><a href="/blog-base/代码精进之路/02.第一模块代码“规范”篇/03"><span>03 | 优秀程序员的六个关键特质</span></a></li><li><a href="/blog-base/代码精进之路/02.第一模块代码“规范”篇/04"><span>04 | 代码规范的价值：复盘苹果公司的GoToFail漏洞</span></a></li><li><a href="/blog-base/代码精进之路/02.第一模块代码“规范”篇/05"><span>05 | 经验总结：如何给你的代码起好名字？</span></a></li><li><a href="/blog-base/代码精进之路/02.第一模块代码“规范”篇/06"><span>06 | 代码整理的关键逻辑和最佳案例</span></a></li><li><a href="/blog-base/代码精进之路/02.第一模块代码“规范”篇/07"><span>07 | 写好注释，真的是小菜一碟吗？</span></a></li><li><a href="/blog-base/代码精进之路/02.第一模块代码“规范”篇/08"><span>08 | 写好声明的“八项纪律”</span></a></li><li><a href="/blog-base/代码精进之路/02.第一模块代码“规范”篇/09"><span>09 | 怎么用好Java注解？</span></a></li><li><a href="/blog-base/代码精进之路/02.第一模块代码“规范”篇/10"><span>10 | 异常处理都有哪些陷阱？</span></a></li><li><a href="/blog-base/代码精进之路/02.第一模块代码“规范”篇/11"><span>11 | 组织好代码段，让人对它“一见钟情”</span></a></li><li><a href="/blog-base/代码精进之路/02.第一模块代码“规范”篇/12"><span>12丨组织好代码文件，要有“用户思维”</span></a></li><li><a href="/blog-base/代码精进之路/02.第一模块代码“规范”篇/13"><span>13 | 接口规范，是协作的合约</span></a></li><li><a href="/blog-base/代码精进之路/02.第一模块代码“规范”篇/14"><span>14 | 怎么写好用户指南？</span></a></li><li><a href="/blog-base/代码精进之路/02.第一模块代码“规范”篇/15"><span>15 | 编写规范代码的检查清单</span></a></li><li><a href="/blog-base/代码精进之路/02.第一模块代码“规范”篇/16"><span>16丨代码“规范”篇用户答疑</span></a></li></ul></li><li><a aria-current="page" class="active" href="/blog-base/代码精进之路/03.第二模块代码“经济”篇">03.第二模块代码“经济”篇</a><ul><li><a href="/blog-base/代码精进之路/03.第二模块代码“经济”篇/01"><span>17 | 为什么需要经济的代码？</span></a></li><li><a href="/blog-base/代码精进之路/03.第二模块代码“经济”篇/02"><span>18丨思考框架：什么样的代码才是高效的代码？</span></a></li><li><a href="/blog-base/代码精进之路/03.第二模块代码“经济”篇/03"><span>19 | 怎么避免过度设计？</span></a></li><li><a href="/blog-base/代码精进之路/03.第二模块代码“经济”篇/04"><span>20 | 简单和直观，是永恒的解决方案</span></a></li><li><a href="/blog-base/代码精进之路/03.第二模块代码“经济”篇/05"><span>21 | 怎么设计一个简单又直观的接口？</span></a></li><li><a href="/blog-base/代码精进之路/03.第二模块代码“经济”篇/06"><span>22丨高效率，从超越线程同步开始！</span></a></li><li><a href="/blog-base/代码精进之路/03.第二模块代码“经济”篇/07"><span>23 | 怎么减少内存使用，减轻内存管理负担？</span></a></li><li><a href="/blog-base/代码精进之路/03.第二模块代码“经济”篇/08"><span>24 | 黑白灰，理解延迟分配的两面性</span></a></li><li><a href="/blog-base/代码精进之路/03.第二模块代码“经济”篇/09"><span>25 | 使用有序的代码，调动异步的事件</span></a></li><li><a href="/blog-base/代码精进之路/03.第二模块代码“经济”篇/10"><span>26 | 有哪些招惹麻烦的性能陷阱？</span></a></li><li><a href="/blog-base/代码精进之路/03.第二模块代码“经济”篇/11"><span>27 | 怎么编写可持续发展的代码？</span></a></li><li><a aria-current="page" class="active" href="/blog-base/代码精进之路/03.第二模块代码“经济”篇/12"><span>28 | 怎么尽量“不写”代码？</span></a></li><li><a href="/blog-base/代码精进之路/03.第二模块代码“经济”篇/13"><span>29 | 编写经济代码的检查清单</span></a></li><li><a href="/blog-base/代码精进之路/03.第二模块代码“经济”篇/14"><span>30丨“代码经济篇”答疑汇总</span></a></li></ul></li><li><a href="/blog-base/代码精进之路/04.第三模块代码“安全”篇">04.第三模块代码“安全”篇</a><ul><li><a href="/blog-base/代码精进之路/04.第三模块代码“安全”篇/01"><span>31 | 为什么安全的代码这么重要？</span></a></li><li><a href="/blog-base/代码精进之路/04.第三模块代码“安全”篇/02"><span>32 | 如何评估代码的安全缺陷？</span></a></li><li><a href="/blog-base/代码精进之路/04.第三模块代码“安全”篇/03"><span>33 | 整数的运算有哪些安全威胁？</span></a></li><li><a href="/blog-base/代码精进之路/04.第三模块代码“安全”篇/04"><span>34 | 数组和集合，可变量的安全陷阱</span></a></li><li><a href="/blog-base/代码精进之路/04.第三模块代码“安全”篇/05"><span>35 | 怎么处理敏感信息？</span></a></li><li><a href="/blog-base/代码精进之路/04.第三模块代码“安全”篇/06"><span>36 | 继承有什么安全缺陷？</span></a></li><li><a href="/blog-base/代码精进之路/04.第三模块代码“安全”篇/07"><span>37 | 边界，信任的分水岭</span></a></li><li><a href="/blog-base/代码精进之路/04.第三模块代码“安全”篇/08"><span>38 | 对象序列化的危害有多大？</span></a></li><li><a href="/blog-base/代码精进之路/04.第三模块代码“安全”篇/09"><span>39 | 怎么控制好代码的权力？</span></a></li><li><a href="/blog-base/代码精进之路/04.第三模块代码“安全”篇/10"><span>40 | 规范，代码长治久安的基础</span></a></li><li><a href="/blog-base/代码精进之路/04.第三模块代码“安全”篇/11"><span>41 | 预案，代码的主动风险管理</span></a></li><li><a href="/blog-base/代码精进之路/04.第三模块代码“安全”篇/12"><span>42 | 纵深，代码安全的深度防御</span></a></li><li><a href="/blog-base/代码精进之路/04.第三模块代码“安全”篇/13"><span>43 | 编写安全代码的最佳实践清单</span></a></li><li><a href="/blog-base/代码精进之路/04.第三模块代码“安全”篇/14"><span>44 | “代码安全篇”答疑汇总</span></a></li></ul></li><li><a href="/blog-base/代码精进之路/05.加餐">05.加餐</a><ul><li><a href="/blog-base/代码精进之路/05.加餐/01"><span>Q&amp;A加餐丨关于代码质量，你关心的那些事儿</span></a></li></ul></li><li><a href="/blog-base/代码精进之路/06.结束语">06.结束语</a><ul><li><a href="/blog-base/代码精进之路/06.结束语/01"><span>结束语｜如何成为一个编程好手？</span></a></li></ul></li><li><a href="/blog-base/代码精进之路/07.期末测试题">07.期末测试题</a><ul><li><a href="/blog-base/代码精进之路/07.期末测试题/01"><span>期末测试丨有关代码编写的那些准则，你掌握了多少呢？</span></a></li></ul></li><li><a href="/blog-base/代码精进之路/summary">代码精进之路</a></li></ul></div></div><ul role="slug-list" class="__dumi-default-layout-toc"><li title="不要重新发明轮子" data-depth="2"><a href="/blog-base/代码精进之路/03.第二模块代码“经济”篇/12#不要重新发明轮子"><span>不要重新发明轮子</span></a></li><li title="推动轮子的改进" data-depth="2"><a href="/blog-base/代码精进之路/03.第二模块代码“经济”篇/12#推动轮子的改进"><span>推动轮子的改进</span></a></li><li title="不要重复多个轮子" data-depth="2"><a href="/blog-base/代码精进之路/03.第二模块代码“经济”篇/12#不要重复多个轮子"><span>不要重复多个轮子</span></a></li><li title="该放手时就放手" data-depth="2"><a href="/blog-base/代码精进之路/03.第二模块代码“经济”篇/12#该放手时就放手"><span>该放手时就放手</span></a></li><li title="小结" data-depth="2"><a href="/blog-base/代码精进之路/03.第二模块代码“经济”篇/12#小结"><span>小结</span></a></li><li title="一起来动手" data-depth="2"><a href="/blog-base/代码精进之路/03.第二模块代码“经济”篇/12#一起来动手"><span>一起来动手</span></a></li></ul><div class="__dumi-default-layout-content"><div class="markdown"><h1 id="28--怎么尽量不写代码"><a aria-hidden="true" tabindex="-1" href="/blog-base/代码精进之路/03.第二模块代码“经济”篇/12#28--怎么尽量不写代码"><span class="icon icon-link"></span></a>28 | 怎么尽量“不写”代码？</h1><p>最有效率的编码就是少编写代码，甚至不编写代码。前面，我们讨论过避免需求膨胀和设计过度，就是减少编码的办法之一。这一次，我们讨论代码复用的问题。商业的规模依赖于可复制性，代码的质量依赖于可复用性。</p><p>比如，Java提供了很多的类库和工具，就是为了让Java程序员不再编写类似的代码，直接拿来使用就可以了。</p><h2 id="不要重新发明轮子"><a aria-hidden="true" tabindex="-1" href="/blog-base/代码精进之路/03.第二模块代码“经济”篇/12#不要重新发明轮子"><span class="icon icon-link"></span></a>不要重新发明轮子</h2><p>“不要重新发明轮子”，这是一个流传甚广的关于软件复用的话。如果已经有了一个轮子，可以拿来复用，就不用再重新发明一个新轮子了。<strong>复用</strong>，是这句话的精髓部分。</p><p>如果没有现成的轮子，我们需要造一个新的。如果造的轮子可以复用，那就再好不过了。造轮子的过程，就是我们设计和实现复用接口的过程。</p><p>我刚参加工作的时候，从事的是银行综合业务系统的研发工作。银行的业务，牵涉到大量的报表。每一个报表的生成和处理，都是一个费力的编码环节。需要大量的代码，反复调试，才能生成一张漂亮的报表。那时候，市面上也没有什么可以使用的解决方案。我有一个同事负责这方面的工作，刚开始的辛苦程度可想而知。</p><p>过了几年，我们再聊起报表业务的时候，发现他已经在报表处理方面建立了巨大的优势。这个优势，就是报表处理代码的复用。他把报表的生成和处理，提炼成了一个使用非常简单的产品。用户只要使用图形界面做些简单的配置，就能生成漂亮的报表。编写大量代码、反复调试的时代，已经一去不复返了。传统的方式需要几个月的工作量，使用这个工具几天时间就搞定了。而且，客户还可以自己定义生成什么样的报表。生成花样报表的需求依然存在，但是再也不需要大量的重复劳动了。这个产品的优势，帮助他赢得了很多重要的客户。</p><p>什么样的代码可以复用呢？**一般来说，当我们使用类似的代码或者类似的功能超过两次时，就应该考虑这样的代码是不是可以复用了。**比如，当我们拷贝粘贴一段代码时，也许会做一点微小的修改，然后用到新的代码里。这时候，我们就要考虑，这段拷贝的代码是不是可以抽象成一个方法？有了抽象出来的方法，我们就不需要把这段代码拷贝到别的地方了。如果这段代码有错误，我们也只需要修改这个方法的实现就可以了。</p><h2 id="推动轮子的改进"><a aria-hidden="true" tabindex="-1" href="/blog-base/代码精进之路/03.第二模块代码“经济”篇/12#推动轮子的改进"><span class="icon icon-link"></span></a>推动轮子的改进</h2><p>轮子发明出来了，并不意味着这个轮子就永远没有问题了。它是需要持续改进的，比如，修改错误，修复安全问题，提高计算性能等等。</p><p>“不要重新发明轮子”这句话的另外一层意思，就是改进现有的轮子。如果发现轮子有问题，不要首先试图去重新发明一个相同的轮子，而是去改进它。</p><p>每一个可以复用的代码，特别是那些经过时间检验的接口，都踩过了很多坑，经过了多年的优化。如果我们试着重新编写一个相同的接口，一般意味着这些坑我们要重新考虑一遍，还不一定能够做得更好。</p><p>比如说吧，我们前面提到了Java核心类库里String类的设计缺陷。为了避免这样的缺陷，我们当然可以发明一个新的MyString类。但是，这意味着我们要维护它以保持它长久的生命力。Java的String类，有OpenJDK社区的强大支撑，有几十亿台设备使用，有专业的人员维护、更新和改进。而我们自己发明的MyString类，就很难有这样的资源和力量去维护它。</p><p>当然，我们也不能坐等轮子的改进。 <strong>如果一个可以复用的代码出了问题，我们要第一时间叫喊起来</strong>。这对代码的维护者而言，是一个发现问题、改进代码的机会。一般来说，代码维护者，都喜欢这样的声音，并且能够及时地反馈。我们可以通过发邮件，提交bug等我们知道的任何渠道，让代码的维护者知晓问题的存在。这样，我们就加入了改进的过程，间接影响了代码的质量。</p><p>使用现有的轮子固然方便，但是如果它满足不了你的需求，或者你不能使用，也不要被“不要重新发明轮子”这句话绊住了脚。需要新轮子的时候，就去发明新轮子。</p><p>如果你去观察市场，每一种好东西，都可能有好几个品牌在竞争。手机不仅仅只有一个品牌，豆浆机也不仅仅只有一个型号，云服务也不仅仅由一家提供，互联网支付也有多种选择。如果仔细看，类似的产品也有很多不同的地方。不同的地方，就是不同的产品有意或者无意做的市场区隔。</p><h2 id="不要重复多个轮子"><a aria-hidden="true" tabindex="-1" href="/blog-base/代码精进之路/03.第二模块代码“经济”篇/12#不要重复多个轮子"><span class="icon icon-link"></span></a>不要重复多个轮子</h2><p>市场上存在多个轮子是合理的。但是在一个软件产品中，一个单一功能，只应该有一个轮子。如果有多个相同的轮子，不仅难以维护，而且难以使用，会造成很多编码的困扰。</p><p>比如说，在JDK 11中，我们引入了一个通过标准名称命名已知参数的类。</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">package java.security.spec;</span></div><div class="token-line"><span class="token plain">    </span></div><div class="token-line"><span class="token plain">    /**</span></div><div class="token-line"><span class="token plain">     * This class is used to specify any algorithm parameters that are determined</span></div><div class="token-line"><span class="token plain">     * by a standard name. </span></div><div class="token-line"><span class="token plain">     * &lt;snipped&gt;</span></div><div class="token-line"><span class="token plain">     */</span></div><div class="token-line"><span class="token plain">    public class NamedParameterSpec implements AlgorithmParameterSpec {</span></div><div class="token-line"><span class="token plain">        public NamedParameterSpec(String standardName) {</span></div><div class="token-line"><span class="token plain">            // snipped</span></div><div class="token-line"><span class="token plain">        }</span></div><div class="token-line"><span class="token plain">    </span></div><div class="token-line"><span class="token plain">        public String getName() {</span></div><div class="token-line"><span class="token plain">            // snipped</span></div><div class="token-line"><span class="token plain">        }</span></div><div class="token-line"><span class="token plain">    }</span></div></pre></div><p>这个类单独看，并没有什么不妥当的地方。但是，如果放在更大范围里来看，这个新添加的类就引起了不小的麻烦。这是因为还存在另外一个相似的扩展类。</p><p>而且，由于这个扩展类和它继承的类，功能几乎完全重合，带来的困扰就是，本来我们只需要一个轮子就能解决的问题，现在不得不考虑两个轮子的问题。而且，由于ECGenParameterSpec的存在，我们还可能忘记了要考虑使用更基础的NamedParameterSpec类。</p><p>问题代码：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">@Override</span></div><div class="token-line"><span class="token plain">    public void initialize(AlgorithmParameterSpec params)</span></div><div class="token-line"><span class="token plain">                throws InvalidAlgorithmParameterException {</span></div><div class="token-line"><span class="token plain">        // snipped</span></div><div class="token-line"><span class="token plain">        if (params instanceof ECGenParameterSpec) {</span></div><div class="token-line"><span class="token plain">            String name = ((ECGenParameterSpec)params).getName();</span></div><div class="token-line"><span class="token plain">        } else {</span></div><div class="token-line"><span class="token plain">            throw new InvalidAlgorithmParameterException(</span></div><div class="token-line"><span class="token plain">                    &quot;ECParameterSpec or ECGenParameterSpec required for EC&quot;);</span></div><div class="token-line"><span class="token plain">        }</span></div><div class="token-line"><span class="token plain">        // snipped</span></div><div class="token-line"><span class="token plain">    }</span></div></pre></div><p>正确代码：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">@Override</span></div><div class="token-line"><span class="token plain">    public void initialize(AlgorithmParameterSpec params)</span></div><div class="token-line"><span class="token plain">                throws InvalidAlgorithmParameterException {</span></div><div class="token-line"><span class="token plain">        // snipped</span></div><div class="token-line"><span class="token plain">        if (params instanceof NamedParameterSpec) {</span></div><div class="token-line"><span class="token plain">            String name = ((NamedParameterSpec)params).getName();</span></div><div class="token-line"><span class="token plain">        } else {</span></div><div class="token-line"><span class="token plain">            throw new InvalidAlgorithmParameterException(</span></div><div class="token-line"><span class="token plain">                    &quot;ECParameterSpec or ECGenParameterSpec required for EC&quot;);</span></div><div class="token-line"><span class="token plain">        }</span></div><div class="token-line"><span class="token plain">        // snipped</span></div><div class="token-line"><span class="token plain">    }</span></div></pre></div><p>上面的问题，是JDK 11引入的一个编码困扰。这个困扰，导致了很多使用的问题。由于是公开接口，它的影响，要经过好多年才能慢慢消除。也许很快，在JDK的某一个版本中，这个扩展的ECGenParameterSpec类就会被废弃掉。</p><h2 id="该放手时就放手"><a aria-hidden="true" tabindex="-1" href="/blog-base/代码精进之路/03.第二模块代码“经济”篇/12#该放手时就放手"><span class="icon icon-link"></span></a>该放手时就放手</h2><p>你有没有这样的体验，一个看起来很微不足道的修改，或者没有任何问题的修改，会带来一连串的连锁反应，导致意想不到的问题出现？</p><p>前不久，OpenJDK调整了两个方法的调用顺序。 大致的修改就像下面的例子。</p><p>修改前：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">Signature getSignature(PrivateKey privateKey,</span></div><div class="token-line"><span class="token plain">        AlgorithmParameterSpec signAlgParameter) throws NoSuchAlgorithmException,</span></div><div class="token-line"><span class="token plain">        InvalidAlgorithmParameterException, InvalidKeyException {</span></div><div class="token-line"><span class="token plain">    </span></div><div class="token-line"><span class="token plain">        Signature signer = Signature.getInstance(&quot;RSASSA-PSS&quot;);</span></div><div class="token-line"><span class="token plain">        if (signAlgParameter != null) {</span></div><div class="token-line"><span class="token plain">            signer.setParameter(signAlgParameter);</span></div><div class="token-line"><span class="token plain">        }</span></div><div class="token-line"><span class="token plain">        signer.initSign(privateKey);</span></div><div class="token-line"><span class="token plain">    </span></div><div class="token-line"><span class="token plain">        return signer;</span></div><div class="token-line"><span class="token plain">    }</span></div></pre></div><p>修改后：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">Signature getSignature(PrivateKey privateKey,</span></div><div class="token-line"><span class="token plain">        AlgorithmParameterSpec signAlgParameter) throws NoSuchAlgorithmException,</span></div><div class="token-line"><span class="token plain">        InvalidAlgorithmParameterException, InvalidKeyException {</span></div><div class="token-line"><span class="token plain">    </span></div><div class="token-line"><span class="token plain">        Signature signer = Signature.getInstance(&quot;RSASSA-PSS&quot;);</span></div><div class="token-line"><span class="token plain">        signer.initSign(privateKey);</span></div><div class="token-line"><span class="token plain">        if (signAlgParameter != null) {</span></div><div class="token-line"><span class="token plain">            signer.setParameter(signAlgParameter);</span></div><div class="token-line"><span class="token plain">        }</span></div><div class="token-line"><span class="token plain">    </span></div><div class="token-line"><span class="token plain">        return signer;</span></div><div class="token-line"><span class="token plain">    }</span></div></pre></div><p>这个修改仅仅调换了一下两个方法的调用顺序。根据这两个方法的接口规范，调用顺序的修改不应该出现任何问题。然而，让人意向不到的是，这个接口的实现者，大都依赖于严格的调用顺序。修改前的调用顺序，已经使用了十多年了，大家都习以为常，认为严格的调用顺序依赖并没有问题。一旦改变了这个调用顺序，很多应用程序就不能正常工作了，就会出现严重的兼容性问题。</p><p>我们每个人都会写很多烂代码，过去写过，未来可能还会再写。这些烂代码，如果运行得很好，没有出现明显的问题，我们就放手吧。</p><p>但不是说烂代码我们就永远不管不问了。那么，什么时候修改烂代码呢？代码投入使用之前，以及代码出问题的时候，就是我们修改烂代码的时候。</p><p>那么代码的修改都有哪些需要注意的地方呢？</p><p>代码规范方面的修改，可以大胆些。比如命名规范、代码整理，这些都动不了代码的逻辑，是安全的修改。</p><p>代码结构方面的修改，则要谨慎些，不要伤及代码的逻辑。比如把嵌套太多的循环拆分成多个方法，把几百行的代码，拆分成不同的方法，把相似的代码抽象成复用的方法，这些也是相对安全的修改。</p><p>代码逻辑方面的修改，要特别小心，除了有明显的问题，我们都尽量避免修改代码的逻辑。即使像上面例子中那样的微小的调用顺序的改变，都可能有意想不到的问题。</p><h2 id="小结"><a aria-hidden="true" tabindex="-1" href="/blog-base/代码精进之路/03.第二模块代码“经济”篇/12#小结"><span class="icon icon-link"></span></a>小结</h2><p>今天，我们聊了代码复用的一些基本概念。关键的有三点：</p><ol><li><p>要提高代码的复用比例，减少编码的绝对数量；</p></li><li><p>要复用外部的优质接口，并且推动它们的改进；</p></li><li><p>烂代码该放手时就放手，以免引起不必要的兼容问题。</p></li></ol><h2 id="一起来动手"><a aria-hidden="true" tabindex="-1" href="/blog-base/代码精进之路/03.第二模块代码“经济”篇/12#一起来动手"><span class="icon icon-link"></span></a>一起来动手</h2><p>今天的练手题，我们来分析下OpenJDK的一个接口设计问题。</p><p>不可更改的集合，是OpenJDK的核心类库提供的一个重要功能。这个功能，有助于我们设计实现“一成不变”的接口，降低编码的复杂度。</p><p>从JDK 1.2开始，这个功能是通过Collections类的方法实现的。比如Collections.unmodifiableList()方法。</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">public static &lt;T&gt; List&lt;T&gt; unmodifiableList​(List&lt;? extends T&gt; list)</span></div><div class="token-line"><span class="token plain">    </span></div><div class="token-line"><span class="token plain">    Returns an unmodifiable view of the specified list. Query operations on the returned list &quot;read through&quot; to the specified list, and attempts to modify the returned list, whether direct or via its iterator, result in an UnsupportedOperationException.</span></div><div class="token-line"><span class="token plain">    </span></div><div class="token-line"><span class="token plain">    The returned list will be serializable if the specified list is serializable. Similarly, the returned list will implement RandomAccess if the specified list does.</span></div><div class="token-line"><span class="token plain">    </span></div><div class="token-line"><span class="token plain">    Type Parameters:</span></div><div class="token-line"><span class="token plain">        T - the class of the objects in the list</span></div><div class="token-line"><span class="token plain">    Parameters:</span></div><div class="token-line"><span class="token plain">        list - the list for which an unmodifiable view is to be returned.</span></div><div class="token-line"><span class="token plain">    Returns:</span></div><div class="token-line"><span class="token plain">        an unmodifiable view of the specified list.</span></div></pre></div><p>在JDK 10里，又添加了新的生成不可更改的集合的方法。比如List.copyOf()方法。</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">static &lt;E&gt; List&lt;E&gt; copyOf​(Collection&lt;? extends E&gt; coll)</span></div><div class="token-line"><span class="token plain">    </span></div><div class="token-line"><span class="token plain">    Returns an unmodifiable List containing the elements of the given Collection, in its iteration order. The given Collection must not be null, and it must not contain any null elements. If the given Collection is subsequently modified, the returned List will not reflect such modifications.</span></div><div class="token-line"><span class="token plain">    </span></div><div class="token-line"><span class="token plain">    Implementation Note:</span></div><div class="token-line"><span class="token plain">        If the given Collection is an unmodifiable List, calling copyOf will generally not create a copy.</span></div><div class="token-line"><span class="token plain">    Type Parameters:</span></div><div class="token-line"><span class="token plain">        E - the List&#x27;s element type</span></div><div class="token-line"><span class="token plain">    Parameters:</span></div><div class="token-line"><span class="token plain">        coll - a Collection from which elements are drawn, must be non-null</span></div><div class="token-line"><span class="token plain">    Returns:</span></div><div class="token-line"><span class="token plain">        a List containing the elements of the given Collection</span></div><div class="token-line"><span class="token plain">    Throws:</span></div><div class="token-line"><span class="token plain">        NullPointerException - if coll is null, or if it contains any nulls</span></div><div class="token-line"><span class="token plain">    Since:</span></div><div class="token-line"><span class="token plain">        10</span></div></pre></div><p>比较两个接口，你能够理解新接口的改进吗？为什么新加了一个接口，而不是改进原来的接口？为什么使用了一个新的类（List），而不是在原来的类（Collections）里加一个新方法？</p><p>欢迎你在留言区讨论上面的问题，我们一起来了解很多接口设计背后的妥协，以及接口演进的办法。也欢迎点击“请朋友读”，把这篇文章分享给你的朋友或者同事，一起交流一下。</p></div><div class="__dumi-default-layout-footer-meta"><a target="_blank" rel="noopener noreferrer" href="https://github.com/GGwujun/blog/edit/master/ssrc/代码精进之路/03.第二模块代码“经济”篇/12.md">在 GitHub 上编辑此页<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><span data-updated-text="最后更新时间：">2023/9/23 17:33:43</span></div></div></div></div>
	<script>
  window.g_useSSR = true;
  window.g_initialProps = {};
	</script>

    <script>
      (function () {
        if (!location.port) {
          (function (i, s, o, g, r, a, m) {
            i["GoogleAnalyticsObject"] = r;
            (i[r] =
              i[r] ||
              function () {
                (i[r].q = i[r].q || []).push(arguments);
              }),
              (i[r].l = 1 * new Date());
            (a = s.createElement(o)), (m = s.getElementsByTagName(o)[0]);
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m);
          })(
            window,
            document,
            "script",
            "//www.google-analytics.com/analytics.js",
            "ga"
          );
          ga("create", "UA-149864185-1", "auto");
          ga("send", "pageview");
        }
      })();
    </script>
    <script src="/blog-base/umi.js"></script>
  </body>
</html>
